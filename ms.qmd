---
title: "Effects of prenatal CORT and temperature on the antipredatory behaviour in a lizard"
format:
  docx: 
    reference-doc: "./bib/tmpl.docx"
bibliography: "./bib/refs.bib"
csl: "./bib/behavioral-ecology-and-sociobiology.csl"
execute:
  echo: false
  error: false
  cache: false
  warning: false
link-citations: true
crossref:  
  fig-title: Fig.    # (default is "Figure")
  title-delim: —     # (default is ":")
  fig-prefix: Fig.   # (default is "Figure")
  tbl-prefix: Table  # (default is "Table")
editor_options: 
  chunk_output_type: console
---

```{r}
#| label: setup
pacman::p_load(tidyverse, flextable, emmeans, DHARMa, brms, here, ggplot2, lme4, zoo, lmerTest, broom, tidybayes, ggh4x, cowplot, fitdistrplus, MASS, goftest, forcats, nortest, fitdistrplus, ggh4x, PupillometryR, png, grid, remotes, ggthemes, bayestestR, HDInterval, DiagrammeR, magick)
```

```{r, cleandata}
#| label: cleandata
# Obtain the main df using "./R/1_data_process.R"
source(here("R", "data_process.R"))
```

```{r, sampleSize}
#| label: sampleSize
# List with the sample sizes from the main database.
source(here("R", "func.R"))
#
species <- c("delicata", "guichenoti")
trt <- c("Control-Cold", "CORT-Cold", "Control-Hot", "CORT-Hot")
#
# Loop over species
for (s in species) {
  n_list <- list() 
  
  data_n <- behav_clean %>%
    filter(day == 0) %>%
    filter(species == s)

  for (k in trt) {
    list_name <- paste0(k)
    group_data <- data_n %>% filter(trt == k)
    n_list[[list_name]] <- nrow(group_data)
    }
  assign(paste0("n_list_", s), n_list)
}
```

```{r, countclutches}
#| label: countclutches
# Count the number of clutches per species
#
clutches_deli <- behav_clean %>% 
  filter(species == "delicata") %>%
  filter(day == 0) %>%
  distinct(clutch) %>% 
  nrow()
#
clutches_guich <- behav_clean %>% 
  filter(species == "guichenoti") %>%
  filter(day == 0) %>%
  distinct(clutch) %>% 
  nrow()
```


Pablo Recio^1,2^,$\ddagger$ , Daniel W.A. Noble^1^, Dalton C. Leibold^1^, Christopher R. Friesen^3,4^, Mathéo Dupuy^1,5^, Ondi L. Crino^1,2^

^1^ Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra, ACT 2601, Australia  
^2^ Flinders University, College of Science and Engineering, Bedford Park, SA 5042, Australia  
^3^ University of Wollongong, Wollongong, NSW 2500, Australia   
^4^ Environmental Futures University of Wollongong, Wollongong, NSW 2500, Australia     
^5^ Institute Universitaire de Technologie Paul Sabatier, Auch 32000, France  
$\ddagger$ Corresponding author: pablo.reciosantiago@anu.edu.au  


ORCID: 

Pablo Recio ORCID: 0000-0002-5890-0218  
Daniel W.A. Noble ORCID: 0000-0001-9460-8743     
Dalton C. Leibold ORCID: 0000-0001-9645-2033  
Christopher R. Friesen ORCID: 0000-0001-5338-7454  
Mathéo Dupuy ORCID:         
Ondi L. Crino ORCID: 0000-0001-5700-1387  


```{r, results='asis', echo=FALSE}
cat("\\newpage")
```


## Introduction

Animals constantly face events that can disrupt their homeostasis. These disruptions can be acute, such as a sudden predator attack, or long-term, like prolonged droughts or habitat degradation [@sapolsky_how_2000; @mcewen_concept_2003]. Regardless of the nature of the challenge, organisms must adjust to allostasis to maintain their physiological and behavioural integrity [@wingfield2002endocrine]. In vertebrates, the ability to cope with disruptions in homeostasis is carried out by the hypothalamic-pituitary-adrenal/interrenal (HPA/HPI) axis [@sapolsky_how_2000]. This system elicits a physiological response, also known as the stress response, mediated by glucocorticoids (GCs) - a group of hormones that facilitates the reallocation of energetic resources to restore homeostasis [@sapolsky_how_2000; @mcewen_concept_2003]. For example, when an animal faces a predatory attack, GCs mobilise energy to support increased locomotor activity, vigilance, or attention to avoid the threat [@trompeter2011invader]. In the short term, GCs help organisms cope with acute challenges. However, long-term exposure to GCs can carry significant metabolic costs, leading to immune suppression, impaired growth, or permanent neural alterations [@picard_mitochondria_2014; @mcewen2017neurobiological]. Furthermore, reacting to stressors can reduce the time and energy available for essential activities such as foraging, thermoregulation, or social interactions [@belliure2004behavioral; @martin2024blind]. As such, animals are predicted to evolve mechanisms to appropriately respond to acute stressors while avoiding the costs in the long term. For example, by regulating their responses to homotypic (repeated and similar) stressors, particularly those that are predictable and non-lethal [@grissom2009habituation]. Habituation - the reduction of physiological responses elicited by exposure to a homotypic stressor [@pfister1979glucocorticosterone] - can be crucial to avoid the long-term costs of chronic stress without compromising the response to acute stressors.   

Importantly, the process of physiological habituation shares key functional characteristics with the cognitive process of habituation - a form of non-associative learning where individuals reduce their responsiveness to a repeated stimulus [@thompson1966habituation]. In both cases, organisms are repeatedly exposed to a stimulus/homotypic stressor and progressively decrease their response toward it [@grissom2009habituation]. In fact, both behavioural and physiological habituation often co-occur. For example, rhesus macaques (_Macaca mulatta_) showed a decline in blood cortisol concentrations across consecutive days of restraint, accompanied by decreased vocalizations and behavioral agitation [@ruys2004behavioral]. However, physiological habituation alone is insufficient to explain the behavioural patterns observed when animals are repeatedly exposed to a processive stressors - those involving primarily psychological qualities, such as restraint or simulated predation  [@jaferi2006corticosterone; @grissom2009habituation]. For example, adrenalectomised rats - incapable of physiological habituation - still exhibit cognitive habituation [@jaferi2006corticosterone], suggesting a degree of independence between the two processes. While the HPA/HPI axis is paramount for physiological habituation, cognitive habituation also involves neural mechanisms related to sensory processing, learning, and behavioural control, such as the limbic system, the superior colliculus, or the optic tectum [@grissom2009habituation; @dutta2014saliency]. Habituation to processive stressors is therefore likely to involve complex interactions between physiological and cognitive processes.    

However, the effectiveness of either system depends on how well the underlying neural structures develop and integrate. Many of these brain regions mature concurrently and can be highly plastic during early stages of development [@coomber_independent_1997; @zhu_prenatal_2004; @amiel_effects_2017]. Early-life conditions can shape the structure and function of both neural systems, with long-term consequences for how individuals respond to acute and chronic stressors [@vargas2016early; @van2017modulation; @zito2017early; @crino_under_2020; @crino2024eggs]. One of the key mediators of early-life effects is GC exposure. Elevations in GCs during development exert potent effects on HPA/HPI axis function, altering the response to stressors later in life [@costantini2011meta; @vargas2016early; @zito2017early; @crino2024eggs]. For example, zebra finches (_Taeniopygia guttata_) nutritionally stressed during early-life had higher levels of CORT than controls at post-hatching day 25, while periodic maternal separation increased basal corticosterone levels in rats (_Rattus norvegicus_) [@vargas2016early; @zito2017early]. In parallel, developmental GC exposure can impact brain regions involved in learning, memory, and behavioural flexibility, affecting neural processes relevant to cognitive habituation [@lemaire_prenatal_2000; @zhu_prenatal_2004; @costantini2011meta]. Therefore, early-life exposure to GCs can have long-lasting effects on the response to both acute and chronic stressors, potentially leading to maladaptive responses in adulthood.   

Other environmental factors may also shape stress-related phenotypes, either independently or in combination with GCs. In ectotherms, early thermal conditions play a critical role in cognitive development [@amiel_effects_2017; @abayarathna_effects_2020]. Incubation temperature affects cognitive abilities such as learning, memory, or perception, likely through changes in brain function and structure [@amiel_smart_2011; @amiel_hotter_2012; @amiel_effects_2017; @dayananda_incubation_2017; @abayarathna_effects_2020]. In addition, early thermal environment can also affect the development of the HPA/HPI axis [@crino_under_2020; @crino2024eggs]. For example, in the delicata skink (_Lampropholis delicata_), individuals incubated at cooler temperatures showed increased baseline CORT concentration in the blood [@crino2024eggs]. Although these differences are believed to be driven by size rather than direct endocrine effects [@crino2024eggs], they can still have important long-term consequences for how individuals respond to acute and chronic stressors. Importantly, incubation temperature and prenatal CORT may not act independently [see @wingfield_comparative_2008; @Crino_2023], and their interaction could produce complex, trait-specific outcomes that shape both physiological and behavioural responses to stress. 

Because of the functional similarities between physiological and cognitive habituation, behavioural responses can offer insight into an animal’s ability to regulate stress over time, even in the absence of physiological measures. This is particularly relevant when investigating early-life programming, which can shape both HPA/I development and brain regions involved in behavioural inhibition and learning [@lemaire_prenatal_2000; @zhu_prenatal_2004; @costantini2011meta; @amiel_hotter_2012]. In this study, we investigated how prenatal CORT and incubation temperature shape the response to a stressor in two species of skinks: the delicate skink (_Lampropholis delicata_) and the common garden skink (_L. guichenoti_). We focused on the effects of these early-life conditions on the behavioural responses to a processive stressor. Specifically, we examined how these factors influence the acute (i.e., the first exposure) and the chronic (i.e., repeated exposures over time) responses by measuring freezing behaviour, shelter seeking, and shelter emergence after a simulated predatory attack. Finally, we assessed body mass change across the stress period as a potential indirect cost, while controlling for food intake. We predicted that prenatal CORT exposure would heighten acute stress reactivity and slow habituation, while warmer incubation temperatures would reduce acute responses and enhance habituation. Furthermore, we predicted higher temperatures would buffer the effects of prenatal CORT on stress responses, potentially leading to more flexible behavioural adjustment. Finally, we expected that less flexible stress responses would lead to higher decreases in mass.    

## Methods

#### Subjects

We used two species of closely skinks, the delicate skink (_Lampropholis delicata_) and the common garden skink (_L. guichenoti_). Both species are oviparous, generalist, small (∼35-55 mm snout-vent length (SVL)) lizards that are sympatric in suburban areas throughout south-eastern Australia [@chapple_know_2011; @chapple_biology_2014]. However, while _L. delicata_ has been reported as a successful invader in New Zealand and Hawaii, there are no such reports for _L. guichenoti_ [@chapple_know_2011; @chapple_biology_2014]. Differences in the ability to colonise new environments are not related to cognitive abilities [@bezzina2014does; @recio2025cognitive; @recio2025early], but could be associated with differences in personality [@chapple_know_2011], which may be linked to different responses to  predatory stimuli [**REFS**].      

#### Collection and housing

*Breeding colony* - Lizards came from a breeding colony established in the laboratory since 2019. This colony consisted of 270 adults of _L. delicata_ and 180 adults of _L. guichenoti_ housed in plastic containers (41.5 L x 30.5 W x 21 H cm) with two males and four females per enclosure. Enclosures were provided with shelter, nonstick matting, and several small water dishes. The lizards were given water daily and were fed approximately 40 mid-size crickets (_Acheta domestica_) per enclosure three days a week. The crickets were dusted with calcium weekly and multivitamins and calcium biweekly. Room temperature was set to 22-24 ºC, but we also provided the enclosures with a heat cord and a heat lamp following a 12 h light:12 h dark cycle, keeping the warm side of the enclosures at 34 ºC.

*Eggs collection and incubation* - Eggs were collected between mid-October 2022 to the end of February 2023. We placed a small box (12.5 L x 8.3 W x 5 H cm) with moist vermiculite on one side of the communal enclosures to provide females with a place to lay the eggs. These boxes were checked three days a week. After egg collection, we measured length and width with a digital caliper to the nearest 0.1 mm and weighed the eggs with a (OHAUS, Model spx123) digital scale with an accuracy of ± 0.001 g error. Then eggs were treated with CORT or vehicle (see CORT and temperature manipulation below) and were placed in individual cups (80 mL) with moist vermiculite (12 parts water to 4 parts vermiculite). The cups were covered with cling wrap to retain moisture and left in two incubators at two different temperatures (see CORT and temperature manipulation below) until hatching.

*Hatchlings* - Incubators were checked three times a week for hatchlings. Lizards were measured and weighed immediately after hatching. Snout-vent length (SVL) and tail length (TL) were measured to the nearest millimeter, and weight was recorded using a (OHAUS, Model spx123) digital scale with an accuracy of ± 0.001 g. Hatchlings were then placed in individual enclosures (18.7L x 13.2W x 6.3H cm) with nonstick matting and a small water dish.  All care otherwise follows similar protocols to adults (see above).  
 
#### CORT and Temperature manipulation

To test the interactive effects of CORT and incubation temperature, we manipulated CORT concentrations in eggs and incubated them at cold (23 ± 3 ºC) or hot (28 ± 3 ºC) conditions (see @fig-Methods A). We used a partial split clutch design where eggs from a given clutch were distributed equally across the four treatments when clutch sizes were larger than four and randomly across treatments when less than four. Eggs were topically supplied with either 5 µL of crystalline corticosterone (Sigma, Cat. No. C2505) dissolved in 100% ethanol at a final 10 pg CORT/mL concentration (CORT treatment), or an equal volume of 100% Ethanol (Control treatment). We selected doses based on our previous study, where CORT treatment increased mean yolk CORT levels by approximately 2 standard deviations above the mean natural concentration [@crino2024eggs]. Mean incubation temperatures represent the lower and upper limits of the natural range of nest temperatures in both species [@qualls2000post; @cheetham2011embryonic].   

#### Antipredatory response     

Three weeks before the start of the behavioural tests, we adapted the lizard enclosures to the experimental setup. The enclosures used for the antipredatory response trials were the same as those where the lizards had previously been housed, but modified to include only a single shelter (9 × 6 × 1.5 cm) placed at one end and a water dish in the centre. All other shelter materials and the matting substrate were removed to allow continuous monitoring. The enclosures were then relocated to the experimental rooms, each containing six racks equipped with their own CCTV system (model DVR-HP210475). The number of lizards per treatment was counterbalanced across racks to control for potential effects of room or rack position. In these three weeks, lizards were fed one calcium- and multivitamin-dusted cricket per day, and water was provided _ad libitum_. A temperature gradient was maintained using heat cords and heat lamps on a 12:12 h light–dark cycle, with room temperatures kept between 22–24 °C.          

To test the effects of prenatal conditions on the short- and long-term antipredatory response, we simulated a predatory attack once daily over multiple days. Each trial began with one of the researchers (PR) removing the water dish from the enclosure, followed by the removal of the shelter. The lizard was then chased for 60 seconds using a soft paintbrush, simulating the predatory attack. Immediately after the chase, the shelter — but not the water dish — was returned to its original position, marking the start of the behavioural observation period. The lizard’s behaviour was then recorded for one hour. All videos were later analysed by MD, who was blinded to the lizards’ treatment. From each video, we recorded three behavioural variables: i) latency to move — the time spent immobile immediately after the simulated attack; ii) latency to shelter — the time it took the lizard to hide under the shelter after resuming movement; and iii) probability to emerge — whether or not the lizard emerged from the shelter during the 40 minutes following hiding (1 = emerged, 0 = did not emerge). A lizard was considered to have resumed movement if it moved continuously for at least five seconds, and to be under shelter if no limbs were visible. All trials were conducted between 1000–1400 h, when lizards were most active.       
            
```{r, fig-Methods}
#| label: fig-Methods
#| fig.cap: "Scheme of our experimental design. In panel A, the early environment manipulations leading to four experimental conditions. In panel B, the postnatal antpredatory response assay, for 8 days, lizards were subjected daily to a simulated predator attack (chased with a soft paintbrush for 1 minute), followed by a 1-hour behavioural recording. During this recording, we measured the latency to move, the latency to shelter, and the probability of emergening from the shelter in 40 minutes after the stressor."

knitr::include_graphics("./Others/Methods.png")

```

#### Statistical analyses

We performed the analyses for each species separately. We fitted a total of six models using the _brm_ package [@burkner2017brms], which fits Bayesian multilevel models with _Stan_ [@stan] with R version 4.5.1 [@R]. We ran four parallel MCMC chains of 10000 iterations for each model, with a warmup period of 4000 iterations. 

We used as the response variables the latency to move, the latency to shelter, and the probability to emerge, modelled separately. We included the prenatal condition (Control-Cold, CORT-Cold, Control-Hot, CORT-Hot), the day of the trial, and their interaction as fixed effects. To facilitate interpretation of the model intercepts, trial day was transformed so that day 1 in the experiment corresponds to day 0 in the model (i.e., the intercept reflects lizard behaviour in response to the first exposure to the stressor). We also included snout-vent length - measured one day before the beginning of the trials - to control for potential effects of size on the antipredatory behaviour [**REFs**]. SVL was centered to the mean to facilitate interpretation of the intercepts.    

We included lizard identity and clutch identity as a random factors. The former was included to account for individual performance over time, while clutch identity was included to control for parental conditions. In this sense, _L. delicata_ lays one clutch per year, while _L. guichenoti_ lays two [@chapple_know_2011; @chapple2015deliinvLHI]. Since eggs were collected during half of the breeding season, each clutch likely comes from a different mother. Additionally, previous research has shown that clutches are generally sired by a single male [@kar2023heritability]. Although sperm storage can occur in these species [@kar2023heritability], given our partial split-clutch design and the fact that maternal effects are expected to be stronger than paternal effects in these species, including the clutch as a random factor should account for the effects of parental identity.     
 
We used the posterior distributions of model parameters to test for differences between prenatal conditions. Differences in the model intercepts between conditions were interpreted as differences in the immediate antipredatory behaviour, while differences in the slopes were interpreted as differences in antipredatory adjustments. We used the 95% Highest Posterior Density Intervals (95% HPDI) using the hdi function in bayestestR [@bayestestR] to test if the contrasts between treatments or the slopes for each treatment were different from zero.       

Differences between species were tested by comparing the posterior distributions of the intercepts and slopes of the different treatments. 95% HPDI were used to test the hypothesis that the contrasts differed from zero.     

All the estimated parameters in the results were transformed back to original units employing appropriate formulas depending on the distribution employed in the models. The error structure for latency to move and latency to shelter followed a lognormal distribution [family = lognormal()], while the probability of emerging from the shelter was modelled using a Bernoulli distribution with a logit link function [family = Bernoulli(link = 'logit')].          

## Results

We started with 96 lizards, 48 per species and 12 per treatment per species. However, our final sample size was 85 due to natural mortality (n = 9). The final sample sizes per treatment and species are listed in @fig-results_beh_deli and @fig-results_beh_guich. These animals came from a total of `r clutches_deli` clutches in _L. delicata_ and `r clutches_guich` in _L. guichenoti_.      

```{r, models_behaviour}
#| label: models_behaviour
source(here("R", "func.R"))
#
refit <- FALSE
#
# A) L. delicata
deli_beh <- behav_clean %>% 
  filter(species == "delicata") %>%
  mutate(lat_move = lat_move + 1, 
         lat_shelter = lat_shelter + 1)
#
deli_move <- fit_m(df = deli_beh, fam = lognormal(), sp = "deli", var = "lat_move")
deli_shelter <- fit_m(df = deli_beh, fam = lognormal(), sp = "deli", var = "lat_shelter")
deli_emergence <- fit_m(df = deli_beh, fam = bernoulli(link = "logit"), sp = "deli", var = "emergence")
#
#
# B) L. guichenoti
guich_beh <- behav_clean %>%
  filter(species == "guichenoti") %>%
  mutate(lat_move = lat_move + 1, 
         lat_shelter = lat_shelter + 1)
#
guich_move <- fit_m(df = guich_beh, fam = lognormal(), sp = "guich", var = "lat_move")
guich_shelter <- fit_m(df = guich_beh, fam = lognormal(), sp = "guich", var = "lat_shelter")
guich_emergence <- fit_m(df = guich_beh, fam = bernoulli(link = "logit"), sp = "guich", var = "emergence")
```

```{r, post_contrasts}
#| label: post_contrasts
#  
source(here("R", "func.R"))
#
# Getting the values for each treatments' intercept and slope for the contrasts later
## A) L. delicata
deli_move_posteriors <- post_values(deli_move)
deli_shelter_posteriors <- post_values(deli_shelter)
deli_emergence_posteriors <- post_values(deli_emergence)
#
## B) L. guichenoti
guich_move_posteriors <- post_values(guich_move)
guich_shelter_posteriors <- post_values(guich_shelter)
guich_emergence_posteriors <- post_values(guich_emergence)
#
#
# Getting the contrasts for the posterior distributions
## A) L. delicata
deli_move_contrasts <- contrasts_func(sp = "deli", res = "move")
deli_shelter_contrasts <- contrasts_func(sp = "deli", res = "shelter")
deli_emergence_contrasts <- contrasts_func(sp = "deli", res = "emergence")
#
## B) L. guichenoti
guich_move_contrasts <- contrasts_func(sp = "guich", res = "move")
guich_shelter_contrasts <- contrasts_func(sp = "guich", res = "shelter")
guich_emergence_contrasts <- contrasts_func(sp = "guich", res = "emergence")
```


#### Do prenatal conditions affect the immediate antipredatory response?

_Lampropholis delicata_: Incubation at cold temperatures decreased the latency to move after a simulated attack on the first day (Intercept (denoted hereafter as I)~Hot~ - I~Cold~ = `r deli_move_contrasts$median_Temperature_int`; 95% Highest Posterior Density Intervals (95% HPDI) = [`r deli_move_contrasts$X2.5.HDI_Temperature_int`, `r deli_move_contrasts$X97.5.HDI_Temperature_int`]), while neither CORT or the interaction have any effect on latency to shelter or emergence (see @fig-results_beh_deli A, D, G and Table S1 in _Supplementary Material_). We did not find any effects of prenatal temperature, CORT or their interaction on latency to shelter or emergence probability on the first day of the assay (see @fig-results_beh_deli A, D, G and Table S1 in _Supplementary Material_). SVL had no significant effect on any of the behavioural responses (see Table S4 in _Supplementary Material_).         


_Lampropholis guichenoti_: Neither prenatal CORT, temperature, nor their interaction had a significant effect on the immediate antipredatory response on _L. guichenoti_ (see @fig-results_beh_guich A, D, G and Table S2 in _Supplementary Material_). We did not see any significant effects of SVL on any of the behavioural responses (see Table S5 in _Supplementary Material_).       


```{r, fig-results_beh_deli}
#| label: fig-results_beh_deli
#| fig.cap: "Behavioural response of _Lampropholis delicata_ to a stressor. Panels A, D, and G show the distribution of the estimates for all the behavioural responses after the first simulated attack per each treatment (i.e., response to acute stressor). In panels B, E, and H the distribution of the estimates of slopes per each treatment (i.e., response to chronic stressor). In all A, B, D, E, G and H the x-axis represents the estimated values, and in the y-axis the density of the estimates. The different colors indicate the different treatments. Points and bars represent the median and 95% Highest Posterior Density Intervals (95% HPDI), respectively. Dashed lines in panels B, E, and H indicate values equal 0 (i.e. no response to chronic stress). Panels C, F, and I show the behavioural estimated values over trials. The lines represent the median estimated value for each trial, and the shaded areas indicate the 95% HPDI; both were obtained using the slope and intercept estimates from the posterior distributions. The different colors indicate the different treatments."
#  
source(here("R", "func.R"))
# First step, create the dfs for all variables
## ACUTE STRESSORS
deli_move_acute <- plotting(sp = "deli", res = "move", type = "int") 
deli_move_chronic <- plotting(sp = "deli", res = "move", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
deli_move_trials <- plotting(sp = "deli", res = "move", type = "trials")
#
deli_shelter_acute <- plotting(sp = "deli", res = "shelter", type = "int")
deli_shelter_chronic <- plotting(sp = "deli", res = "shelter", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
deli_shelter_trials <- plotting(sp = "deli", res = "shelter", type = "trials")
#
deli_emergence_acute <- plotting(sp = "deli", res = "emergence", type = "int")
deli_emergence_chronic <- plotting(sp = "deli", res = "emergence", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
deli_emergence_trials <- plotting(sp = "deli", res = "emergence", type = "trials")
#
# Getting the legend
legend_plot <- plotting(sp = "deli", res = "move", type = "int") + 
  theme(legend.position = "bottom", legend.title = element_blank())
gtable <- ggplotGrob(legend_plot)
legend <- gtable$grobs[[which(sapply(gtable$grobs, function(x) x$name) == "guide-box")]]
#
# Merge the plots
deli_beh <- plot_grid(deli_move_acute, deli_move_chronic, deli_move_trials,
                      deli_shelter_acute, deli_shelter_chronic, deli_shelter_trials,
                      deli_emergence_acute, deli_emergence_chronic, deli_emergence_trials,
                      ncol = 3, nrow = 3,
                      rel_widths = c(0.75, 0.75, 1))
#
fig_deli_beh <- ggdraw() +
  # Make background white
  theme(plot.background = element_rect(fill = "white", color = NA)) +
  # Insert legend 
  draw_grob(legend, x = 0.49, y = 0.015, width = 0.01, height = 0.01) +
  # Add the final plot but with reduced size for the legend and "title"
  draw_plot(deli_beh, x = 0, y = 0.04, width = 1, height = 0.91) +
  # Insert title for each plot
  annotate("text", x = 0.02, y = 0.948, label = "A", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.948, label = "B", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.948, label = "C", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.02, y = 0.645, label = "D", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.645, label = "E", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.645, label = "F", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.02, y = 0.341, label = "G", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.341, label = "H", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.341, label = "I", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  # Insert name species
  annotate("text", x = 0.58, y = 0.99, label = "Lampropholis delicata", hjust = 1, vjust = 1, size = 6, fontface = "italic")
#
ggsave("./output/figures/main/fig_deli_beh.png", plot=fig_deli_beh, width = 21, height = 25, units = "cm", dpi = 600)
ggsave("./BEHPROC/submitted_material/fig_deli_beh.pdf", plot=fig_deli_beh, width = 22, height = 26, units = "cm", dpi = 1200)
knitr::include_graphics("./output/figures/main/fig_deli_beh.png")
```


#### Do prenatal conditions affect the long-term antipredatory response?

_Lampropholis delicata_: CORT-treated lizards incubated at cold temperatures increased their latency to move over time (Slope (denoted hereafter as β) = `r format_dec(median(deli_move_posteriors$slope_CORT_Cold), 3)`; 95% HPDI = [`r format_dec(hdi(deli_move_posteriors$slope_CORT_Cold, credMass = 0.95)[1], 3)`, `r format_dec(hdi(deli_move_posteriors$slope_CORT_Cold, credMass = 0.95)[2], 3)`]), while the slopes were not different from zero in the rest of the treatments (see @fig-results_beh_deli B, C and Table S3 in _Supplementary Material_). However, constrasts between between treatments showed no effect of prenatal conditions on the latency to move througout the experiments (see Table S1 in _Supplementary Material_). Lizards from all treatments increased the probability of emerging from the shelter throughout the experiment (β > 0 in all cases, see @fig-results_beh_deli H, I and Table S3 in _Supplementary Material_), with no differences between treatments (see Table S1 in _Supplementary Material_). In contrast, the latency to shelter did not change over time (β = 0 in all cases, see @fig-results_beh_deli E, F and Table S3 in _Supplementary Material_). The contrasts between treatments showed no differences in the slopes (see Table S1 in _Supplementary Material_).     


_Lampropholis guichenoti_: Behavioral responses towards a stressor did not change over time in _L. guichenoti_ (see @fig-results_beh_guich B, C, E, F, H, I and Table S3 in _Supplementary Material_). There were no significant differences in the behavioural response of _L. guichenoti_ to the repeated exposure to a stressor (see @fig-results_beh_guich B, C, E, F, H, I and Table S2 in _Supplementary Material_).      

```{r, fig-results_beh_guich}
#| label: fig-results_beh_guich
#| fig.cap: "Behavioural response of _Lampropholis guichenoti_ to a stressor. Panels A, D, and G show the distribution of the estimates for all the behavioural responses after the first simulated attack per each treatment (i.e., response to acute stressor). In panels B, E, and H the distribution of the estimates of slopes per each treatment (i.e., response to chronic stressor). In all A, B, D, E, G and H the x-axis represents the estimated values, and in the y-axis the density of the estimates. The different colors indicate the different treatments. Points and bars represent the median and 95% Highest Posterior Density Intervals (95% HPDI), respectively. Dashed lines in panels B, E, and H indicate values equal 0 (i.e. no response to chronic stress). Panels C, F, and I show the behavioural estimated values over trials. The lines represent the median estimated value for each trial, and the shaded areas indicate the 95% HPDI; both were obtained using the slope and intercept estimates from the posterior distributions. The different colors indicate the different treatments." 
#
source(here("R", "func.R"))
# First step, create the dfs for all variables
## ACUTE STRESSORS
guich_move_acute <- plotting(sp = "guich", res = "move", type = "int") 
guich_move_chronic <- plotting(sp = "guich", res = "move", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
guich_move_trials <- plotting(sp = "guich", res = "move", type = "trials")
#
guich_shelter_acute <- plotting(sp = "guich", res = "shelter", type = "int")
guich_shelter_chronic <- plotting(sp = "guich", res = "shelter", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
guich_shelter_trials <- plotting(sp = "guich", res = "shelter", type = "trials")
#
guich_emergence_acute <- plotting(sp = "guich", res = "emergence", type = "int")
guich_emergence_chronic <- plotting(sp = "guich", res = "emergence", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
guich_emergence_trials <- plotting(sp = "guich", res = "emergence", type = "trials")
#
# Getting the legend
legend_plot <- plotting(sp = "guich", res = "move", type = "int") + 
  theme(legend.position = "bottom", legend.title = element_blank())
gtable <- ggplotGrob(legend_plot)
legend <- gtable$grobs[[which(sapply(gtable$grobs, function(x) x$name) == "guide-box")]]
#
# Merge the plots
guich_beh <- plot_grid(guich_move_acute, guich_move_chronic, guich_move_trials,
                      guich_shelter_acute, guich_shelter_chronic, guich_shelter_trials,
                      guich_emergence_acute, guich_emergence_chronic, guich_emergence_trials,
                      ncol = 3, nrow = 3,
                      rel_widths = c(0.75, 0.75, 1))
#
fig_guich_beh <- ggdraw() +
  # Make background white
  theme(plot.background = element_rect(fill = "white", color = NA)) +
  # Insert legend 
  draw_grob(legend, x = 0.49, y = 0.015, width = 0.01, height = 0.01) +
  # Add the final plot but with reduced size for the legend and "title"
  draw_plot(guich_beh, x = 0, y = 0.04, width = 1, height = 0.91) +
  # Insert title for each plot
  annotate("text", x = 0.02, y = 0.948, label = "A", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.948, label = "B", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.948, label = "C", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.02, y = 0.645, label = "D", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.645, label = "E", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.645, label = "F", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.02, y = 0.341, label = "G", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.341, label = "H", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.341, label = "I", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  # Insert name species
  annotate("text", x = 0.58, y = 0.99, label = "Lampropholis guichenoti", hjust = 1, vjust = 1, size = 6, fontface = "italic")
#
ggsave("./output/figures/main/fig_guich_beh.png", plot=fig_guich_beh, width = 21, height = 25, units = "cm", dpi = 600)
ggsave("./BEHPROC/submitted_material/fig_guich_beh.pdf", plot=fig_guich_beh, width = 22, height = 26, units = "cm", dpi = 1200)
knitr::include_graphics("./output/figures/main/fig_guich_beh.png")
```


## Discussion    
We predicted that elevated CORT levels in eggs or incubating them at colder temperatures would increase lizards reactivity to a stressor both in the first encounter or during repeated exposure. Higher reactivity would imply larger latencies to move after the simulated attack, lower times until sheltering, and lower probabilities of emerging from the shelter.   

Our study shows that early-life conditions can influence how skinks respond to a processive stressor, but the effects differ between species, the nature of the stressor, and the behaviour evaluated. _Lampropholis delicata_ incubated at warmer temperatures were less reactive to a simulated predator attack in the first trial, suggesting that early thermal conditions can shape the behavioural response to an acute stressor. In contrast, _L. guichenoti_ showed no treatment effects. Habituation patterns also differed. _Lampropholis delicata_ increased the probability of emerging from the shelter, suggesting some habituation to the stressor. However, none of the treatments showed habituation in latency to move or go to shelter. No behavioural change was detected in _L. guichenoti_ either. Finally, we found no evidence of physiological costs: individuals generally maintained or gained body mass, regardless of treatment. Together, these findings suggest that incubation temperature and prenatal hormone exposure shape stress-related behaviour in a species-specific manner, potentially reflecting differences in flexibility or stress physiology.        

#### Cold incubation temperature increases the response to an acute stressor in _L. delicata_ but not in _L. guichenoti_    
We found that the early-life conditions can impact lizards' response to an acute stressor, but this effects were species- and behaviour-dependent. Our results demonstrate that incubation temperature can modulate the behavioural response to an acute stressor in _L. delicata_ but not in _L. guichenoti_. Hot-incubated _L. delicata_ spent less time immobile following a simulated predatory attack, suggesting a faster recovery from acute stress. This result is consistent with the idea that shorter immobility duration (i.e., shorter freezing time) reflects a less reactive behavioural response, often associated to lower HPA/HPI activity [@koolhaas1999coping]. In _L. delicata_, individuals incubated at 23 ºC exhibit elevated baseline CORT [@crino2024eggs], potentially enhancing sensitivity to stress. Therefore, the heightened acute response in cold-incubated individuals may be explained by elevated endogenous CORT. Alternatively, the higher latency times to move may reflect impaired neural development caused by cold incubation. Colder incubation temperatures can disrupt the formation and connectivity of brain regions involved in sensory processing and behavioural control [@coomber_independent_1997; @sakata_neural_2000; @amiel_effects_2017], ultimately leading to slower perception and action planning during freezing [@roelofs2022freezing].     

In contrast, incubation temperature had no effect on _L. guichenoti_'s response to an acute stressor, suggesting that stress reactivity in this species is more robust to early thermal environment. Our findings align with previous studies showing that incubation temperature impacts the antipredatory behaviour of _L. delicata_ but not _L. guichenoti_ [@iglesias2024maternal]. Between-species differences on the effect of incubation temperature could reflect differences in history-traits such as egg size. Smaller eggs in _L. delicata_ may make this species more sensitive to environmental alterations during development, with consequences for their physiology and behaviour later in life [@crino2024eggs; @iglesias2024maternal]. Although heightened plasticity may enable _L. delicata_ to fine-tune its phenotype to local conditions, it could also increase vulnerability to suboptimal environments. In contrast, the apparent robustness of _L. guichenoti_ might buffer against certain environmental inputs but limit flexibility [@fox2019beyond]. Future studies should explore how these differing developmental strategies influence fitness across different environments.    

#### Prenatal CORT did not influence behavioural response to an acute stressor     
Given the significant effects of prenatal GCs on the development of the HPA/HPI axis reported in other species [@costantini2011meta; @vargas2016early; @zito2017early; @crino2024eggs], we predicted prenatal CORT elevations to increase lizards' reactivity to acute stressors. However, we found no effects of prenatal CORT elevations on any of the behaviours analysed, and these results were consistent across species. These findings suggest that the response to acute stressors is robust to CORT elevations.       

Alternatively, our CORT manipulation may have failed to elicit significant effects. Glucocorticoids are known to have hormetic effects on different traits [@mcewen_concept_2003]. While our CORT treatment was efficient in elevating yolk CORT concentrations, they did not result in increased baseline CORT in juveniles[@crino2024eggs]. In contrast, doses at lower concentration did [@crino2024eggs]. Previous reports show that enhanced responsiveness to acute stressors are usually accompanied by higher baseline GC levels [@koolhaas1999coping; @ruys2004behavioral; @thaker2009acute]. Therefore, the absence of CORT effects on the acute response may reflect the lack of endocrine differences between treatment groups in _L. delicata_. However, this mechanism remains speculative for _L. guichenoti_, as comparable endocrine data are currently lacking. Further experiments would benefit from studying how exposing eggs to lower CORT concentrations influence stress-related physiology and behaviours in both species.          

#### The effects of prenatal conditions on the response to a repeated stressor are species-dependent   
We predicted that, over time, lizards would decrease the latency to move while increasing both the latency to shelter and the probability of emerging from the shelter. These patterns would reflect a more relaxed response to a processive stressor, indicative of cognitive habituation [@koolhaas1999coping; @grissom2009habituation]. We also expected that prenatal CORT exposure or cold incubation would impair habituation, given their known effects on the HPI axis and cognitive development [@lemaire_prenatal_2000; @zhu_prenatal_2004; @costantini2011meta; @amiel_hotter_2012; @vargas2016early; @zito2017early; @crino2024eggs]. Nonetheless, our results show complex patterns were habituation differs across species, treatments, and behavioural measures.     

Only _L. delicata_ showed evidence that early-life conditions influenced the response to a chronic stressor. Although slope contrasts did no reveal significant differences between treatments, the CORT-Cold group was the only one where the latency to move changed significantly over time. However, instead of the predicted reduction, we found an increase in the time spent frozen after the simulated attack, suggesting sensititazion to the stressor rather than habituation. This result may reflect a cumulative effect of prenatal CORT and cold incubation temperatures, even in the absence of a statistically significant interaction. In _L. delicata_, cold incubation alone increases baseline CORT levels in juveniles [@crino2024eggs]. Although the high CORT dose used in our experiment did not significantly elevate baseline CORT on its own, it produced intermediate values between controls and a lower dose — the latter of which did significantly elevate baseline levels [@crino2024eggs]. Therefore, it is possible that the combination of cold incubation and the intermediate endocrine effect of the high CORT dose could together increase HPI axis activity enough to enlarge behavioural reactivity over time [@koolhaas1999coping].          

Alternatively, the combination of CORT and cold temperatures could be impairing habituation trough effects on neural development [see @lemaire_prenatal_2000; @zhu_prenatal_2004; @amiel_hotter_2012; @amiel_effects_2017]. Although previous studies found no influence of prenatal CORT or temperature on associative and reversal learning [@recio2025cognitive; @recio2025early], the effect of prenatal conditions can vary by brain region [@coomber_independent_1997; @sakata_neural_2000]. Possibly, neural structure of regions involved cognitive habituation are more sensitive to early-life conditions than those related to other cognitive domains. Further work is needed to test this possibility and identify the specific neural mechanisms linking developmental conditions to stress-related behavioural flexibility.

#### _L. delicata_, but not _L. guichenoti_, shows habituation to a processive stressor    
We found that _L. delicata_ increased the probability of emergence from the shelter, which suggest that risk perception decreased over time. In contrast, _L. guichenoti_ showed no sign of habituation. Although the slopes did not significantly differ between species for most of the treatments (see @table_contrasts_species), contrasts show that change over time was overall larger in _L. delicata_. Futhermore, only in _L. delicata_ slopes were different from zero, suggesting that there are differences between species in the habituation to a processive stressor. Differences in habituation may contribute to _L. delicata_'s success as an invasive species, as greater flexiblility in responding to processive stressors could facilitate adaptation to new environments [@chapple_biology_2014; @chapple2015deliinvLHI]. For instance, learning to reassess risk based on previous exposure can reduce the costs of the antipredatory response [@lima1990behavioral]. Moreover, cognitive habituation may reflect and individual's capacity to cope with the physiological toll of chronic stress [@grissom2009habituation], a potentially advantageous trait when colonising new habitats [@wingfield2013comparative; @surkova2024flexible].     

Nevertheless, the relative contribution of cognitive versus physiological mechanisms to habituate remains unclear. Previous studies found no differences in associative learning or behavioural flexibility between _L. delicata_ and _L. guichenoti_ [@bezzina2014does; @recio2025cognitive; @recio2025early], suggesting that cognitive processes alone may not explain the between-species differences observed here. Likewise, baseline CORT levels do not fully account for the patterns either: hot-incubated _L. delicata_, which exhibit lower baseline CORT [@crino2024eggs], did not habituate faster than cold-incubated lizards. Instead, our results point to a complex interaction between cognitive and physiological habituation. Future studies that measure behavioural traits and CORT dynamics concurrently should be performed to disentangle the cognitive and physiological components of habituation.     

#### Physiological costs of the stressor were low and did not differ between treatments or species      
Given the metabolic toll that enhanced GC levels impose on animals [@sapolsky_how_2000; @picard_mitochondria_2014], we predicted that repeated exposure to a stressor would influence body mass. Furthermore, we expected those costs to be related to alterarions in stress reactivity shaped by prenatal conditions. In contrast, we found treatment effects in mass change, and most of the lizards gained rather than lost mass. Notably, mass change did not differ between species despite differences in their flexibility to respond to a chronic stressor - a trait oftenly associated with more effective coping [@grissom2009habituation]. These findings suggest that repeated exposure to a processive stressor imposes minimal metabolic costs on _L. delicata_ and _L. guichenoti_.    

Nevertheless, we cannot exclude the possibility that other, subtler physiological costs occurred but were not captured by overall changes in mass. Other studies report impairments in immune suppression, impaired growth, or permanent neural alterations following repeated exposure to systemic and processive stressors  [@picard_mitochondria_2014; @mcewen2017neurobiological]. Future research should investigate how chronic stress impacts other physiological traits, and whether developmental conditions modulate the associated costs.    

#### Conclusion
Our study demonstrates that incubation temperature and prenatal CORT can shape behavioural responses to stress in a species- and context-dependent manner. _Lampropholis delicata_ showed greater plasticity in response to both acute and repeated exposure to a processive stressor, while _L. guichenoti_ appeared robust to prenatal conditions. These species differences may reflect divergent developmental strategies, with potential implications for ecological resilience and invasion success. Despite measurable behavioural differences, we found no evidence of metabolic costs - measured as changes in mass - associated with stress exposure under our experimental conditions. Together, our findings highlight the value of behavioural measures as accessible indicators of stress response and developmental plasticity. Future research integrating hormonal and neural data will be key to understanding the mechanisms underlying behavioural flexibility and its fitness consequences across environments.    

## References
<div id="refs"></div>

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

## Supplementary material

_Table S1. Contrasts of the posterior distributions of the predictors for each behavioural variable modelled for L. delicata. The contrasts are between the intercepts and slopes of the different treatments. 95% Highest Posterior Density Intervals (95% HPDI) test the hypothesis that the contrasts are different from zero._     

```{r, table_contrasts_deli}
#| label: table_contrasts_deli
#
source(here("R", "func.R"))
# 
# Get the posterior contrasts for L. delicata and merge them into a single df
contrast_deli_beh <- bind_rows(move = deli_move_contrasts,
                              shelter = deli_shelter_contrasts,
                              emergence = deli_emergence_contrasts,
                              .id = "variable") %>%
                    mutate(across(everything(), as.character)) %>%
                    
                    rename_with(~ str_replace_all(., "X2\\.5\\.HDI_", "low_lim_")) %>%
                    rename_with(~ str_replace_all(., "X97\\.5\\.HDI_", "up_lim_")) %>%
 
                    pivot_longer(cols = -variable,
                                names_to = c("type", "factor", "stat"),
                                names_pattern = "(median|low_lim|up_lim)_(.*)_(int|slope)") %>%
 
                    pivot_wider(names_from = c(type, stat),
                                values_from = value) %>%
                    
                    mutate(CI_int = paste0("[", low_lim_int, ", ", up_lim_int, "]"),
                          CI_slope = paste0("[", low_lim_slope, ", ", up_lim_slope, "]")) %>%
                    
                    dplyr::select(variable, factor, median_int, CI_int,
                                  median_slope, CI_slope) %>%
data.frame()
write.csv(contrast_deli_beh, here("./output/checking/contrasts_deli_beh.csv"))
#
#
# Set defaults for the table
set_flextable_defaults(
  font.family = "Times New Roman",
  font.size = 10)
#
# Make Table
table_deli_behaviour <- flextable(contrast_deli_beh) %>%
  flextable::compose(i = 1, j = 1, value = as_paragraph("Variable"), part = "header") %>% # Change the first column header
  flextable::compose(i = 1, j = 2, value = as_paragraph("Predictor"), part = "header") %>% # Change the second column header
  flextable::compose(i = 1, j = c(3,5), value = as_paragraph("Contrast"), part = "header") %>% # Change the third column header
  flextable::compose(i = 1, j = c(4,6), value = as_paragraph("95% HPDI"), part = "header") %>% # Change the fourth column header
  flextable::add_header_row(values = c("", "Acute (Intercept)", "Chronic (Slope)"), colwidths = c(2, 2, 2)) %>% # Add a header row
  flextable::compose(i = c(2,3,5,6,8,9), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
  flextable::compose(i = 1, j = 1, value = as_paragraph("Latency to move"), part = "body") %>% # Change the first row of the first column
  flextable::compose(i = 4, j = 1, value = as_paragraph("Latency to shelter"), part = "body") %>% # Change the fourth row of the first column
  flextable::compose(i = 7, j = 1, value = as_paragraph("Emergence"), part = "body") %>% # Change the seventh row of the first column
  flextable::hline(i = c(3,6), part = "body") %>% # Add horizontal lines
  flextable::vline(j = c(2,4), part = "all") %>% # Add vertical lines
  align(align = "center", j = c(3:6), part = "body") %>%
  align(align = "center", i = c(1,2), j = c(1:6), part = "header") %>%
  flextable::bold(i = 1, j = c(3,4), bold = TRUE, part = "body") %>% 
autofit()
#
table_deli_behaviour
```

Contrasts were done by:  
    - _Temperature_: β~Hot~ - β~Cold~  
    - _CORT_: β~CORT~ - β~Control~  
    - _Interaction_: (β~Control-Hot~ - β~CORT-Hot~) - (β~Control-Cold~ - β~CORT-Cold~)  


```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

_Table S2. Contrasts of the posterior distributions of the predictors for each behavioural variable modelled for L. guichenoti. The contrasts are between the intercepts and slopes of the different treatments. 95% Highest Density Intervals (95% HPDI) test the hypothesis that the contrasts are different from zero._    

```{r, table_contrasts_guich}
#| label: table_contrasts_guich
#
source(here("R", "func.R"))
# 
# Get the posterior contrasts for L. guichenoti and merge them into a single df
contrast_guich_beh <- bind_rows(move = guich_move_contrasts,
                              shelter = guich_shelter_contrasts,
                              emergence = guich_emergence_contrasts,
                              .id = "variable") %>%
                    mutate(across(everything(), as.character)) %>%
                    
                    rename_with(~ str_replace_all(., "X2\\.5\\.HDI_", "low_lim_")) %>%
                    rename_with(~ str_replace_all(., "X97\\.5\\.HDI_", "up_lim_")) %>%
 
                    pivot_longer(cols = -variable,
                                names_to = c("type", "factor", "stat"),
                                names_pattern = "(median|low_lim|up_lim)_(.*)_(int|slope)") %>%
 
                    pivot_wider(names_from = c(type, stat),
                                values_from = value) %>%
                    
                    mutate(CI_int = paste0("[", low_lim_int, ", ", up_lim_int, "]"),
                          CI_slope = paste0("[", low_lim_slope, ", ", up_lim_slope, "]")) %>%
                    
                    dplyr::select(variable, factor, median_int, CI_int,
                                  median_slope, CI_slope) %>%
data.frame()
write.csv(contrast_guich_beh, here("./output/checking/contrasts_guich_beh.csv"))
#
#
# Set defaults for the table
set_flextable_defaults(
  font.family = "Times New Roman",
  font.size = 10)
#
# Make Table
table_guich_behaviour <- flextable(contrast_guich_beh) %>%
  flextable::compose(i = 1, j = 1, value = as_paragraph("Variable"), part = "header") %>% # Change the first column header
  flextable::compose(i = 1, j = 2, value = as_paragraph("Predictor"), part = "header") %>% # Change the second column header
  flextable::compose(i = 1, j = c(3,5), value = as_paragraph("Contrast"), part = "header") %>% # Change the third column header
  flextable::compose(i = 1, j = c(4,6), value = as_paragraph("95% HPDI"), part = "header") %>% # Change the fourth column header
  flextable::add_header_row(values = c("", "Acute (Intercept)", "Chronic (Slope)"), colwidths = c(2, 2, 2)) %>% # Add a header row
  flextable::compose(i = c(2,3,5,6,8,9), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
  flextable::compose(i = 1, j = 1, value = as_paragraph("Latency to move"), part = "body") %>% # Change the first row of the first column
  flextable::compose(i = 4, j = 1, value = as_paragraph("Latency to shelter"), part = "body") %>% # Change the fourth row of the first column
  flextable::compose(i = 7, j = 1, value = as_paragraph("Emergence"), part = "body") %>% # Change the seventh row of the first column
  flextable::hline(i = c(3,6), part = "body") %>% # Add horizontal lines
  flextable::vline(j = c(2,4), part = "all") %>% # Add vertical lines
  align(align = "center", j = c(3:6), part = "body") %>%
  align(align = "center", i = c(1,2), j = c(1:6), part = "header") %>% 
autofit()
#
table_guich_behaviour
```

Contrasts were done by:  
    - _Temperature_: β~Hot~ - β~Cold~  
    - _CORT_: β~CORT~ - β~Control~  
    - _Interaction_: (β~Control-Hot~ - β~CORT-Hot~) - (β~Control-Cold~ - β~CORT-Cold~)  



```{r, results='asis', echo=FALSE}
cat("\\newpage") 
```

_Table S3. Values of the slopes for the different treatments for each behavioural variable modelled for both species. 95% Highest Density Intervals (95% HPDI) test the hypothesis that the slopes are different from zero._

```{r, table_slopes}
#| label: table_slopes
#
source(here("R", "func.R"))
#
# Get the slopes for both species in a common df
sp <- c("deli", "guich")
var <- c("move", "shelter", "emergence")
#
slopes_table_df <- data.frame()
for(i in sp){
  for(j in var){    
    model_object <- get(paste0(i, "_", j, "_posteriors")) %>%      
      dplyr::select(starts_with("slope_")) %>%
      rename_with(~ str_replace_all(., "slope_", "")) %>%
      pivot_longer(cols = everything(), names_to = "treatment", values_to = "slope") %>%
      group_by(treatment) %>%
      summarize(
        Median = format_dec(median(slope), 3),
        lowlim = format_dec(hdi(slope, credMass = 0.95)[1], 3),
        uplim = format_dec(hdi(slope, credMass = 0.95)[2], 3)) %>%
      mutate(species = i, variable = j)

    slopes_table_df <- rbind(slopes_table_df, model_object)
  }
}
#
table_slopes_df <- slopes_table_df %>%
  mutate(CI = paste0("[", lowlim, ", ", uplim, "]")) %>%
  dplyr::select(species, variable, treatment, Median, CI) %>%
  mutate(treatment = str_replace_all(treatment, "_", "-"),
         treatment = factor(treatment, levels = c("Control-Cold",
                                                  "CORT-Cold",
                                                  "Control-Hot",
                                                  "CORT-Hot")),
        variable = factor(variable, levels = c("move", "shelter", "emergence"))) %>%
  arrange(species, variable, treatment) %>%
data.frame()
write.csv(table_slopes_df, here("./output/checking/table_slopes.csv"))
#
# Set defaults for the table
set_flextable_defaults(
  font.family = "Times New Roman",
  font.size = 10)
#
# Make Table
table_slopes <- flextable(table_slopes_df) %>%
  flextable::compose(i = 1, j = 1, value = as_paragraph("Species"), part = "header") %>% # Change the first column header
  flextable::compose(i = 1, j = 2, value = as_paragraph("Variable"), part = "header") %>% # Change the second column header
  flextable::compose(i = 1, j = 3, value = as_paragraph("Treatment"), part = "header") %>% # Change the third column header
  flextable::compose(i = 1, j = 5, value = as_paragraph("95% HPDI"), part = "header") %>% # Change the fifth column header
  flextable::compose(i = c(2:12,14:24), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
  flextable::compose(i = 1, j = 1, value = as_paragraph(as_i("L. delicata")), part = "body") %>% # Change the first row of the first column
  flextable::compose(i = 13, j = 1, value = as_paragraph(as_i("L. guichenoti")), part = "body") %>% # Change the fourth row of the first column
  flextable::compose(i = c(2:4,6:8,10:12,14:16,18:20,22:24), j = 2, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the second column
  flextable::compose(i = c(1,13), j = 2, value = as_paragraph("Latency to move"), part = "body") %>% # Change the first row of the first column
  flextable::compose(i = c(5,17), j = 2, value = as_paragraph("Latency to shelter"), part = "body") %>% # Change the fourth row of the first column
  flextable::compose(i = c(9,21), j = 2, value = as_paragraph("Emergence"), part = "body") %>% # Change the seventh row of the first column
  flextable::hline(i = c(4,8,16,20), j = c(2:5),part = "body") %>% # Add horizontal lines
  flextable::hline(i = 12, part = "body") %>% # Add horizontal lines
  bold(i = c(2,9,10,11,12), j = c(3:5), bold = TRUE, part = "body") %>% # Bold significant values
  align(align = "center", j = c(4,5), part = "body") %>%
  align(align = "center", j = c(1:5), part = "header") %>% 
autofit()
#
table_slopes
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

```{r, clean_posteriors_tables}
#| label: clean_posteriors_tables
source(here("R", "func.R"))
#
variables <- c("move", "shelter", "emergence")
species <- c("deli", "guich")
# Initialize empty lists
posterior_list <- list(deli = list(), guich = list())
# Loop over species and variables
for(i in species){
  for(j in variables){
    model_object <- get(paste0(i, "_", j))
    result <- tidy_post(df = model_object)
    posterior_list[[i]][[j]] <- result
  }
}
#
deli_post <- dplyr::bind_rows(posterior_list$deli, .id = "variable") %>%
  mutate(CI = paste0("[", low_lim, ", ", up_lim, "]")) %>%                  
  dplyr::select(variable, Predictor, Median, CI) %>%
data.frame()
#
guich_post <- dplyr::bind_rows(posterior_list$guich, .id = "variable") %>%
  mutate(CI = paste0("[", low_lim, ", ", up_lim, "]")) %>%                  
  dplyr::select(variable, Predictor, Median, CI) %>%
data.frame()
```

_Table S4. Estimates of each predictor for each variable modelled for L. delicata. 95% Highest Density Intervals (95% HPDI) test the hypothesis that the estimates are different from zero._

```{r, tablesummary_deli}
#| label: tablesummary_deli
#
# Table defaults
set_flextable_defaults(
 font.family = "Times New Roman",
 font.size = 10)
# Make Table
table_summ_deli <- flextable(deli_post) %>%
  flextable::compose(i = 1, j = 1, value = as_paragraph("Variable"), part = "header") %>% # Change the first column header
  align(align = "center", j = c(3,4), part = "body") %>%
  align(align = "center", j = c(1:4), part = "header") %>%
  flextable::compose(i = c(2:9,11:18,20:27), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
  flextable::hline(i = c(9,18), part = "body") %>% # Add horizontal lines
  bold(i = c(1,3,8,10,19,20,22), j = c(2:4), bold = TRUE, part = "body") %>% # Bold significant values
  autofit()
#
table_summ_deli
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

_Table S5. Estimates of each predictor for each variable modelled for L. guichenoti. 95% Highest Density Intervals (95% HPDI) test the hypothesis that the estimates are different from zero._

```{r, tablesummary_guich}
#| label: tablesummary_guich
#
# Table defaults
set_flextable_defaults(
 font.family = "Times New Roman",
 font.size = 10)
# Make Table
table_summ_guich <- flextable(guich_post) %>%
  flextable::compose(i = 1, j = 1, value = as_paragraph("Variable"), part = "header") %>% # Change the first column header
  align(align = "center", j = c(3,4), part = "body") %>%
  align(align = "center", j = c(1:4), part = "header") %>% 
  flextable::compose(i = c(2:9,11:18,20:27), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
  flextable::hline(i = c(9,18), part = "body") %>% # Add horizontal lines
  bold(i = c(1,10,26,27), j = c(2:4), bold = TRUE, part = "body") %>% # Bold significant values
  autofit()
#
table_summ_guich
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```


