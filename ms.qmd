---
title: "Antipredatory strategies are robust to prenatal CORT and temperature in two skink species"
format:
  docx: 
    reference-doc: "./bib/tmpl.docx"
bibliography: "./bib/refs.bib"
csl: "./bib/behavioral-ecology-and-sociobiology.csl"
execute:
  echo: false
  error: false
  cache: false
  warning: false
link-citations: true
crossref:  
  fig-title: Fig.    # (default is "Figure")
  title-delim: —     # (default is ":")
  fig-prefix: Fig.   # (default is "Figure")
  tbl-prefix: Table  # (default is "Table")
editor_options: 
  chunk_output_type: console
---

```{r}
#| label: setup
pacman::p_load(tidyverse, flextable, emmeans, DHARMa, brms, here, ggplot2, lme4, zoo, lmerTest, broom, tidybayes, ggh4x, cowplot, fitdistrplus, MASS, goftest, forcats, nortest, fitdistrplus, ggh4x, PupillometryR, png, grid, remotes, ggthemes, bayestestR, HDInterval, DiagrammeR, magick)
```

```{r, cleandata}
#| label: cleandata
# Obtain the main df using "./R/1_data_process.R"
source(here("R", "data_process.R"))
```

```{r, sampleSize}
#| label: sampleSize
# List with the sample sizes from the main database.
source(here("R", "func.R"))
#
species <- c("delicata", "guichenoti")
trt <- c("Control-Cold", "CORT-Cold", "Control-Hot", "CORT-Hot")
#
# Loop over species
for (s in species) {
  n_list <- list() 
  
  data_n <- behav_clean %>%
    filter(day == 0) %>%
    filter(species == s)

  for (k in trt) {
    list_name <- paste0(k)
    group_data <- data_n %>% filter(trt == k)
    n_list[[list_name]] <- nrow(group_data)
    }
  assign(paste0("n_list_", s), n_list)
}
```

```{r, countclutches}
#| label: countclutches
# Count the number of clutches per species
#
clutches_deli <- behav_clean %>% 
  filter(species == "delicata") %>%
  filter(day == 0) %>%
  distinct(clutch) %>% 
  nrow()
#
clutches_guich <- behav_clean %>% 
  filter(species == "guichenoti") %>%
  filter(day == 0) %>%
  distinct(clutch) %>% 
  nrow()
```


Pablo Recio^1,2^,$\ddagger$ , Daniel W.A. Noble^1^, Dalton C. Leibold^1^, Christopher R. Friesen^3,4^, Mathéo Dupuy^1,5^, Ondi L. Crino^1,2^

^1^ Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra, ACT 2601, Australia  
^2^ Flinders University, College of Science and Engineering, Bedford Park, SA 5042, Australia  
^3^ University of Wollongong, Wollongong, NSW 2500, Australia   
^4^ Environmental Futures University of Wollongong, Wollongong, NSW 2500, Australia     
^5^ Institute Universitaire de Technologie Paul Sabatier, Auch 32000, France  
$\ddagger$ Corresponding author: pablo.reciosantiago@anu.edu.au  


ORCID: 

Pablo Recio ORCID: 0000-0002-5890-0218  
Daniel W.A. Noble ORCID: 0000-0001-9460-8743     
Dalton C. Leibold ORCID: 0000-0001-9645-2033  
Christopher R. Friesen ORCID: 0000-0001-5338-7454  
Mathéo Dupuy ORCID:         
Ondi L. Crino ORCID: 0000-0001-5700-1387  


```{r, results='asis', echo=FALSE}
cat("\\newpage")
```


## Introduction

Predation risk is a prominent ecological pressure that can shape the behavior, physiology, and life histories of prey species [@lima1990behavioral; @brown1999ecology]. To reduce the likelihood of being detected, attacked or captured, prey animals have developed a suite of antipredatory strategies, including morphological defences, behavioral tactics, and physiological adjustments [@stankowich2005fear]. However, these strategies are usually costly, leading to trade-offs between antipredatory avoidance and other fitness-related traits [@lima1990behavioral; @stankowich2005fear]. To optimize benefits over costs, animals must carefully evaluate predation risks and respond accurately to them, adjusting their responses to changing risk levels [@lima1990behavioral; @chen2025zebra]. This plasticity allows animals to balance the costs and benefits of avoiding predation in dynamic environments [@amo2005flexibility; @chen2025zebra].       

However, there is considerable variation in how animals cope with predation risk [@stankowich2005fear; @thaker2009alternative; @horvath2020ain]. Some individuals exhibit strong antipredatory responses or adjust more accurately their strategies under changing risk levels than others [@stankowich2005fear; @thaker2009alternative]. Cognition and the stress response system can be key factors predicting individual differences in the antipredatory response [@griffin2001learning; @kelley2003learned; @shier2007effects; @thaker2009acute; @thaker2010stress]. First, cognitive proceeses like predator detection and accurate decision-making are essential for avoiding predation, while behaving flexibly is fundamental to optimize antipredatory responses under different circumstances [@griffin2001learning; @kelley2003learned]. Second, the stress response system - mediated by the hypothalamic-pituitary-adrenal (HPA) or hypothalamic-pituitary-interrenal (HPI) axis - plays a crucial role in mediating behavioral and physiological responses to predation [@thaker2009acute; @thaker2010stress]. Under threat, the HPA/HPI axis triggers the release of glucocorticoids (GCs), which help mobilize resources to cope with imminent risk [@sapolsky_how_2000]. Therefore, cognitive processes and the stress response system likely interact to determine how animals can cope with predation risk. As such, investigating the factors that influence cognitive development and HPA/HPI function is fundamental to understanding individual differences in antipredatory responses and their plasticity.         

Early-life environment is critical for the development of both cognitive function and the HPA/HPI axis [@lemaire_prenatal_2000; @jafari2017prenatal; @abayarathna_effects_2020; @crino2024eggs]. Stressful conditions during development can lead to long-lasting alterations in cognitive abilities and GCs regulation [@lemaire_prenatal_2000; @zhu_prenatal_2004; @jafari2017prenatal; @crino2024eggs]. Prenatal stress or GC exposure can impact neural processes relevant to perception or behavioral flexibility [@lemaire_prenatal_2000; @zhu_prenatal_2004; @costantini2011meta; @meunier2020olfactory], or alter the HPA/HPI axis function leading to changes in stress responsiveness and coping strategies [@koolhaas1999coping; @jafari2017prenatal]. Although evidence is mixed, most studies suggest that prenatal GC elevations produce individuals that are more reactive to threats and less behaviorally flexible [@koolhaas1999coping; but see @recio2025early].     

However, other aspects of the early-life environment can also influence cognitive processes or modulate the effects of GC exposure [@amiel_smart_2011; @dayananda_incubation_2017; @abayarathna_effects_2020]. Factors that, as prenatal GC exposure, can alter metabolic function during development, typically have significant long-lasting effects on brain function and cognition [@amiel_effects_2017]. In this regard, temperature is a prominent environmental factor influencing metabolic rates in ectotherms [@schulte2015effects; @noble_developmental_2018]. As such, prenatal thermal environment shapes multiple traits in ectotherms, including cognitive processes [@amiel_smart_2011; @dayananda_incubation_2017; @noble_developmental_2018; @vila_pouca_incubation_2018; @vila_pouca_quantity_2019; @abayarathna_effects_2020]. For example, incubation at higher temperatures in several species of lizards is associated with improved cognition and more dense neural structures [@amiel_smart_2011; @amiel_hotter_2012; @amiel_effects_2017]. Therefore, prenatal thermal environment can influence antipredatory behavior and its flexibility through effects on cognitive processes [see @burger_antipredator_1998].    

Since both temperature and GC exposure can influence the antipredatory response through similar mechanisms, we could expect prenatal GCs and temperature have interactive effects on antipredatory strategies. Importantly, this interaction is likely ecologically relevant, as extreme environmental temperatures experienced by mothers can increase GCs transmitted to offspring [@racic_effects_2020; @Crino_2023]. However, the combined effects of prenatal GC exposure and incubation temperature on antipredatory strategies remain poorly understood.      

The aim of the present study is to examine how prenatal conditions - particularly prenatal GCs exposure and thermal environment - can shape the antipredatory response and its flexibility in ectotherms. We investigated the combined effects of prenatal corticosterone (CORT) - the primary GC in reptiles - and incubation temperature on the antipredatory behavior and the antipredatory behavioral flexibility in two closely related skink species, the delicate skink (_Lampropholis delicata_) and the common garden skink (_L. guichenoti_). We experimentally manipulated CORT levels in eggs and incubated them at either cold or hot temperatures. After hatching, we assessed the lizards' antipredatory response and their ability to adjust this behavior over repeated exposures to a simulated predator attack. Given the known effects of prenatal GCs and temperature on brain development and HPA/HPI function [@jafari2017prenatal; @lemaire_prenatal_2000; @abayarathna_effects_2020; @crino2024eggs], we hypothesized that prenatal CORT exposure would enhance antipredatory response. However, it may reduce antipredatory behavioral flexibility. Additionally, we predicted that hot incubation temperatures would improve behavioral adjustments and buffer the effects of prenatal CORT on antipredatory behavior [@amiel_smart_2011; @amiel_hotter_2012; @amiel_effects_2017].     

Finally, we explored potential species differences in the effects of prenatal conditions on antipredatory strategies. In this sense, although both species share similar life-histories, habitats, and distributions [@chapple_know_2011; @chapple_biology_2014], only _L. delicata_ has been reported as a successful coloniser outside their natural range [@chapple_know_2011; @chapple_biology_2014]. These differences in the ability to colonise new environments are not related to cognitive abilities [@chapple_know_2011; @recio2025cognitive; @recio2025early], but could be associated with differences in personality [@chapple_know_2011], which may be linked to different antipredatory strategies [@amo2005flexibility; @horvath2020ain].                    

## Methods

#### Collection and housing

*Breeding colony* - Lizards came from a breeding colony established in the laboratory since 2019. This colony consisted of 270 adults of _L. delicata_ and 180 adults of _L. guichenoti_ housed in plastic containers (41.5 L x 30.5 W x 21 H cm) with two males and four females per enclosure. Enclosures were provided with shelter, nonstick matting, and several small water dishes. The lizards were given water daily and were fed approximately 40 mid-size crickets (_Acheta domestica_) per enclosure three days a week. The crickets were dusted with calcium weekly and multivitamins and calcium biweekly. Room temperature was set to 22-24 ºC, but we also provided the enclosures with a heat cord and a heat lamp following a 12 h light:12 h dark cycle, keeping the warm side of the enclosures at 34 ºC.

*Eggs collection and incubation* - Eggs were collected between mid-October 2022 to the end of February 2023. We placed a small box (12.5 L x 8.3 W x 5 H cm) with moist vermiculite on one side of the communal enclosures to provide females with a place to lay the eggs. These boxes were checked three days a week. After egg collection, we measured length and width with a digital caliper to the nearest 0.1 mm and weighed the eggs with a (OHAUS, Model spx123) digital scale with an accuracy of ± 0.001 g error. Then eggs were treated with CORT or vehicle (see CORT and temperature manipulation below) and were placed in individual cups (80 mL) with moist vermiculite (12 parts water to 4 parts vermiculite). The cups were covered with cling wrap to retain moisture and left in two incubators at two different temperatures (see CORT and temperature manipulation below) until hatching.

*Hatchlings* - Incubators were checked three times a week for hatchlings. Lizards were measured and weighed immediately after hatching. Snout-vent length (SVL) and tail length (TL) were measured to the nearest millimeter, and weight was recorded using a (OHAUS, Model spx123) digital scale with an accuracy of ± 0.001 g. Hatchlings were then placed in individual enclosures (18.7L x 13.2W x 6.3H cm) with nonstick matting and a small water dish.  All care otherwise follows similar protocols to adults (see above).  
 
#### CORT and Temperature manipulation

To test the interactive effects of CORT and incubation temperature, we manipulated CORT concentrations in eggs and incubated them at cold (23 ± 3 ºC) or hot (28 ± 3 ºC) conditions (see @fig-Methods A). We used a partial split clutch design where eggs from a given clutch were distributed equally across the four treatments when clutch sizes were larger than four and randomly across treatments when less than four. Eggs were topically supplied with either 5 µL of crystalline corticosterone (Sigma, Cat. No. C2505) dissolved in 100% ethanol at a final 10 pg CORT/mL concentration (CORT treatment), or an equal volume of 100% Ethanol (Control treatment). We selected doses based on our previous study, where CORT treatment increased mean yolk CORT levels by approximately 2 standard deviations above the mean natural concentration [@crino2024eggs]. Mean incubation temperatures represent the lower and upper limits of the natural range of nest temperatures in both species [@qualls2000post; @cheetham2011embryonic].   

#### Antipredatory response     

Three weeks before the start of the behavioral tests, we adapted the lizard enclosures to the experimental setup. The enclosures used for the antipredatory response trials were the same as those where the lizards had previously been housed, but modified to include only a single shelter (9 × 6 × 1.5 cm) placed at one end and a water dish in the centre. All other shelter materials and the matting substrate were removed to allow continuous monitoring. The enclosures were then relocated to the experimental rooms, each containing six racks equipped with their own CCTV system (model DVR-HP210475). The number of lizards per treatment was counterbalanced across racks to control for potential effects of room or rack position. In these three weeks, lizards were fed one calcium- and multivitamin-dusted cricket per day, and water was provided _ad libitum_. A temperature gradient was maintained using heat cords and heat lamps on a 12:12 h light–dark cycle, with room temperatures kept between 22–24 °C.          

To test the effects of prenatal conditions on the short- and long-term antipredatory response, we simulated a predatory attack once daily over multiple days. Each trial began with one of the researchers (PR) removing the water dish from the enclosure, followed by the removal of the shelter. The lizard was then chased for 60 seconds using a soft paintbrush, simulating the predatory attack. Immediately after the chase, the shelter — but not the water dish — was returned to its original position, marking the start of the behavioral observation period. The lizard’s behavior was then recorded for one hour. All videos were later analyzed by MD, who was blinded to the lizards’ treatment. From each video, we recorded three behavioral variables: i) latency to move — the time spent immobile immediately after the simulated attack; ii) latency to shelter — the time it took the lizard to hide under the shelter after resuming movement; and iii) probability to emerge — whether or not the lizard emerged from the shelter during the 40 minutes following hiding (1 = emerged, 0 = did not emerge). A lizard was considered to have resumed movement if it moved continuously for at least five seconds, and to be under shelter if no limbs were visible. All trials were conducted between 1000–1400 h, when lizards were most active.       
            
```{r, fig-Methods}
#| label: fig-Methods
#| fig.cap: "Scheme of our experimental design. In panel A, the early environment manipulations leading to four experimental conditions. In panel B, the postnatal antpredatory response assay, for 8 days, lizards were subjected daily to a simulated predator attack (chased with a soft paintbrush for 1 minute), followed by a 1-hour behavioral recording. During this recording, we measured the latency to move, the latency to shelter, and the probability of emergening from the shelter in 40 minutes after the stressor."

knitr::include_graphics("./Others/Methods.png")

```

#### Statistical analyses

We performed the analyses for each species separately. We fitted a total of six models using the _brm_ package [@burkner2017brms], which fits Bayesian multilevel models with _Stan_ [@stan] with R version 4.5.1 [@R]. We ran four parallel MCMC chains of 10000 iterations for each model, with a warmup period of 4000 iterations. 

We used as the response variables the latency to move, the latency to shelter, and the probability to emerge, modelled separately. We included the prenatal condition (Control-Cold, CORT-Cold, Control-Hot, CORT-Hot), the day of the trial, and their interaction as fixed effects. To facilitate interpretation of the model intercepts, trial day was transformed so that day 1 in the experiment corresponds to day 0 in the model. We also included snout-vent length - measured one day before the beginning of the trials - to control for potential effects of size on the antipredatory behavior [@stankowich2005fear]. SVL was centered to the mean to facilitate interpretation of the intercepts.    

We included lizard identity and clutch identity as a random factors. The former was included to account for individual performance over time, while clutch identity was included to control for parental conditions. In this sense, _L. delicata_ lays one clutch per year, while _L. guichenoti_ lays two [@chapple_know_2011; @chapple2015deliinvLHI]. Since eggs were collected during half of the breeding season, each clutch likely comes from a different mother. Additionally, previous research has shown that clutches are generally sired by a single male [@kar2023heritability]. Although sperm storage can occur in these species [@kar2023heritability], given our partial split-clutch design and the fact that maternal effects are expected to be stronger than paternal effects in these species, including the clutch as a random factor should account for the effects of parental identity.     
 
We used the posterior distributions of model parameters to test for differences between prenatal conditions. Differences in the model intercepts between conditions were interpreted as differences in the immediate antipredatory behavior, while differences in the slopes were interpreted as differences in antipredatory flexibility. We used the 95% Highest Posterior Density Intervals (95% HPDI) using the hdi function in bayestestR [@bayestestR] to test if the contrasts between treatments or the slopes for each treatment were different from zero.       

Differences between species were tested by comparing the posterior distributions of the intercepts and slopes of the different treatments. 95% HPDI were used to test the hypothesis that the contrasts differed from zero.     

All the estimated parameters in the results were transformed back to original units unless otherwise indicated. To back-transformed the results, we employed appropriate formulas depending on the distribution used in the models. The error structure for latency to move and latency to shelter followed a lognormal distribution [family = lognormal()], while the probability of emerging from the shelter was modelled using a Bernoulli distribution with a logit link function [family = Bernoulli(link = 'logit')].          

## Results

We started with 96 lizards, 48 per species and 12 per treatment per species. However, our final sample size was 85 due to natural mortality (n = 9). The final sample sizes per treatment and species are listed in @fig-results_beh_deli and @fig-results_beh_guich. These animals came from a total of `r clutches_deli` clutches in _L. delicata_ and `r clutches_guich` in _L. guichenoti_.      

```{r, models_behavior}
#| label: models_behavior
source(here("R", "func.R"))
#
refit <- FALSE
#
# A) L. delicata
deli_beh <- behav_clean %>% 
  filter(species == "delicata") %>%
  mutate(lat_move = lat_move + 1, 
         lat_shelter = lat_shelter + 1)
#
deli_move <- fit_m(df = deli_beh, fam = lognormal(), sp = "deli", var = "lat_move")
deli_shelter <- fit_m(df = deli_beh, fam = lognormal(), sp = "deli", var = "lat_shelter")
deli_emergence <- fit_m(df = deli_beh, fam = bernoulli(link = "logit"), sp = "deli", var = "emergence")
#
#
# B) L. guichenoti
guich_beh <- behav_clean %>%
  filter(species == "guichenoti") %>%
  mutate(lat_move = lat_move + 1, 
         lat_shelter = lat_shelter + 1)
#
guich_move <- fit_m(df = guich_beh, fam = lognormal(), sp = "guich", var = "lat_move")
guich_shelter <- fit_m(df = guich_beh, fam = lognormal(), sp = "guich", var = "lat_shelter")
guich_emergence <- fit_m(df = guich_beh, fam = bernoulli(link = "logit"), sp = "guich", var = "emergence")
```

```{r, post_contrasts}
#| label: post_contrasts
#  
source(here("R", "func.R"))
#
# Getting the values for each treatments' intercept and slope for the contrasts later
## A) L. delicata
deli_move_posteriors <- post_values(deli_move)
deli_shelter_posteriors <- post_values(deli_shelter)
deli_emergence_posteriors <- post_values(deli_emergence)
#
## B) L. guichenoti
guich_move_posteriors <- post_values(guich_move)
guich_shelter_posteriors <- post_values(guich_shelter)
guich_emergence_posteriors <- post_values(guich_emergence)
#
#
# Getting the contrasts for the posterior distributions
## A) L. delicata
deli_move_contrasts <- contrasts_func(sp = "deli", res = "move")
deli_shelter_contrasts <- contrasts_func(sp = "deli", res = "shelter")
deli_emergence_contrasts <- contrasts_func(sp = "deli", res = "emergence")
#
## B) L. guichenoti
guich_move_contrasts <- contrasts_func(sp = "guich", res = "move")
guich_shelter_contrasts <- contrasts_func(sp = "guich", res = "shelter")
guich_emergence_contrasts <- contrasts_func(sp = "guich", res = "emergence")
```


#### Do prenatal conditions affect the immediate antipredatory response?

_Lampropholis delicata_: Neither prenatal CORT, temperature, nor their interaction had a significant effect on the antipredatory response on the antipredatory behavior of _L. delicata_ (see @fig-results_beh_deli A, D, G and Table S1 in _Supplementary Material_). SVL had no significant effect on any of the behavioral responses (see Table S4 in _Supplementary Material_).         


_Lampropholis guichenoti_: Neither prenatal CORT, temperature, nor their interaction had a significant effect on the antipredatory response on _L. guichenoti_ (see @fig-results_beh_guich A, D, G and Table S2 in _Supplementary Material_). We did not see any significant effects of SVL on any of the behavioral responses (see Table S5 in _Supplementary Material_).       


```{r, fig-results_beh_deli}
#| label: fig-results_beh_deli
#| fig.cap: "behavioral response of _Lampropholis delicata_ to a stressor. Panels A, D, and G show the distribution of the estimates for all the behavioral responses after the first simulated attack per each treatment (i.e., response to acute stressor). In panels B, E, and H the distribution of the estimates of slopes per each treatment (i.e., response to chronic stressor). In all A, B, D, E, G and H the x-axis represents the estimated values, and in the y-axis the density of the estimates. The different colors indicate the different treatments. Points and bars represent the median and 95% Highest Posterior Density Intervals (95% HPDI), respectively. Dashed lines in panels B, E, and H indicate values equal 0 (i.e. no response to chronic stress). Panels C, F, and I show the behavioral estimated values over trials. The lines represent the median estimated value for each trial, and the shaded areas indicate the 95% HPDI; both were obtained using the slope and intercept estimates from the posterior distributions. The different colors indicate the different treatments."
#  
source(here("R", "func.R"))
# First step, create the dfs for all variables
## ACUTE STRESSORS
deli_move_acute <- plotting(sp = "deli", res = "move", type = "int") 
deli_move_chronic <- plotting(sp = "deli", res = "move", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
deli_move_trials <- plotting(sp = "deli", res = "move", type = "trials")
#
deli_shelter_acute <- plotting(sp = "deli", res = "shelter", type = "int")
deli_shelter_chronic <- plotting(sp = "deli", res = "shelter", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
deli_shelter_trials <- plotting(sp = "deli", res = "shelter", type = "trials")
#
deli_emergence_acute <- plotting(sp = "deli", res = "emergence", type = "int")
deli_emergence_chronic <- plotting(sp = "deli", res = "emergence", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
deli_emergence_trials <- plotting(sp = "deli", res = "emergence", type = "trials")
#
# Getting the legend
legend_plot <- plotting(sp = "deli", res = "move", type = "int") + 
  theme(legend.position = "bottom", legend.title = element_blank())
gtable <- ggplotGrob(legend_plot)
legend <- gtable$grobs[[which(sapply(gtable$grobs, function(x) x$name) == "guide-box")]]
#
# Merge the plots
deli_beh <- plot_grid(deli_move_acute, deli_move_chronic, deli_move_trials,
                      deli_shelter_acute, deli_shelter_chronic, deli_shelter_trials,
                      deli_emergence_acute, deli_emergence_chronic, deli_emergence_trials,
                      ncol = 3, nrow = 3,
                      rel_widths = c(0.75, 0.75, 1))
#
fig_deli_beh <- ggdraw() +
  # Make background white
  theme(plot.background = element_rect(fill = "white", color = NA)) +
  # Insert legend 
  draw_grob(legend, x = 0.49, y = 0.015, width = 0.01, height = 0.01) +
  # Add the final plot but with reduced size for the legend and "title"
  draw_plot(deli_beh, x = 0, y = 0.04, width = 1, height = 0.91) +
  # Insert title for each plot
  annotate("text", x = 0.02, y = 0.948, label = "A", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.948, label = "B", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.948, label = "C", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.02, y = 0.645, label = "D", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.645, label = "E", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.645, label = "F", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.02, y = 0.341, label = "G", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.341, label = "H", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.341, label = "I", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  # Insert name species
  annotate("text", x = 0.58, y = 0.99, label = "Lampropholis delicata", hjust = 1, vjust = 1, size = 6, fontface = "italic")
#
ggsave("./output/figures/main/fig_deli_beh.png", plot=fig_deli_beh, width = 21, height = 25, units = "cm", dpi = 600)
ggsave("./BEHPROC/submitted_material/fig_deli_beh.pdf", plot=fig_deli_beh, width = 22, height = 26, units = "cm", dpi = 1200)
knitr::include_graphics("./output/figures/main/fig_deli_beh.png")
```


#### Do prenatal conditions affect the antipredatory flexibility?

_Lampropholis delicata_: CORT-treated lizards incubated at cold temperatures increased their latency to move over time (Slope (denoted hereafter as β) = `r format_dec(median(deli_move_posteriors$slope_CORT_Cold), 3)`; 95% HPDI = [`r format_dec(hdi(deli_move_posteriors$slope_CORT_Cold, credMass = 0.95)[1], 3)`, `r format_dec(hdi(deli_move_posteriors$slope_CORT_Cold, credMass = 0.95)[2], 3)`]), while the slopes were not different from zero in the rest of the treatments (see @fig-results_beh_deli B, C and Table S3 in _Supplementary Material_). However, constrasts between between treatments showed no effect of prenatal conditions on the latency to move througout the experiments (see Table S1 in _Supplementary Material_). Lizards from all treatments increased the probability of emerging from the shelter throughout the experiment (β > 0 in all cases, see @fig-results_beh_deli H, I and Table S3 in _Supplementary Material_), with no differences between treatments (see Table S1 in _Supplementary Material_). In contrast, the latency to shelter did not change over time (β = 0 in all cases, see @fig-results_beh_deli E, F and Table S3 in _Supplementary Material_). The contrasts between treatments showed no differences in the slopes (see Table S1 in _Supplementary Material_).     


_Lampropholis guichenoti_: We did not see any antipredatory flexibility in _L. guichenoti_, reflected by slopes being no different from 0 (see @fig-results_beh_guich B, C, E, F, H, I and Table S3 in _Supplementary Material_).       

```{r, fig-results_beh_guich}
#| label: fig-results_beh_guich
#| fig.cap: "behavioral response of _Lampropholis guichenoti_ to a stressor. Panels A, D, and G show the distribution of the estimates for all the behavioral responses after the first simulated attack per each treatment (i.e., response to acute stressor). In panels B, E, and H the distribution of the estimates of slopes per each treatment (i.e., response to chronic stressor). In all A, B, D, E, G and H the x-axis represents the estimated values, and in the y-axis the density of the estimates. The different colors indicate the different treatments. Points and bars represent the median and 95% Highest Posterior Density Intervals (95% HPDI), respectively. Dashed lines in panels B, E, and H indicate values equal 0 (i.e. no response to chronic stress). Panels C, F, and I show the behavioral estimated values over trials. The lines represent the median estimated value for each trial, and the shaded areas indicate the 95% HPDI; both were obtained using the slope and intercept estimates from the posterior distributions. The different colors indicate the different treatments." 
#
source(here("R", "func.R"))
# First step, create the dfs for all variables
## ACUTE STRESSORS
guich_move_acute <- plotting(sp = "guich", res = "move", type = "int") 
guich_move_chronic <- plotting(sp = "guich", res = "move", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
guich_move_trials <- plotting(sp = "guich", res = "move", type = "trials")
#
guich_shelter_acute <- plotting(sp = "guich", res = "shelter", type = "int")
guich_shelter_chronic <- plotting(sp = "guich", res = "shelter", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
guich_shelter_trials <- plotting(sp = "guich", res = "shelter", type = "trials")
#
guich_emergence_acute <- plotting(sp = "guich", res = "emergence", type = "int")
guich_emergence_chronic <- plotting(sp = "guich", res = "emergence", type = "slop") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black")
guich_emergence_trials <- plotting(sp = "guich", res = "emergence", type = "trials")
#
# Getting the legend
legend_plot <- plotting(sp = "guich", res = "move", type = "int") + 
  theme(legend.position = "bottom", legend.title = element_blank())
gtable <- ggplotGrob(legend_plot)
legend <- gtable$grobs[[which(sapply(gtable$grobs, function(x) x$name) == "guide-box")]]
#
# Merge the plots
guich_beh <- plot_grid(guich_move_acute, guich_move_chronic, guich_move_trials,
                      guich_shelter_acute, guich_shelter_chronic, guich_shelter_trials,
                      guich_emergence_acute, guich_emergence_chronic, guich_emergence_trials,
                      ncol = 3, nrow = 3,
                      rel_widths = c(0.75, 0.75, 1))
#
fig_guich_beh <- ggdraw() +
  # Make background white
  theme(plot.background = element_rect(fill = "white", color = NA)) +
  # Insert legend 
  draw_grob(legend, x = 0.49, y = 0.015, width = 0.01, height = 0.01) +
  # Add the final plot but with reduced size for the legend and "title"
  draw_plot(guich_beh, x = 0, y = 0.04, width = 1, height = 0.91) +
  # Insert title for each plot
  annotate("text", x = 0.02, y = 0.948, label = "A", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.948, label = "B", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.948, label = "C", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.02, y = 0.645, label = "D", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.645, label = "E", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.645, label = "F", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.02, y = 0.341, label = "G", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.318, y = 0.341, label = "H", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  annotate("text", x = 0.615, y = 0.341, label = "I", hjust = 1, vjust = 1, size = 6, fontface = "bold") +
  # Insert name species
  annotate("text", x = 0.58, y = 0.99, label = "Lampropholis guichenoti", hjust = 1, vjust = 1, size = 6, fontface = "italic")
#
ggsave("./output/figures/main/fig_guich_beh.png", plot=fig_guich_beh, width = 21, height = 25, units = "cm", dpi = 600)
ggsave("./BEHPROC/submitted_material/fig_guich_beh.pdf", plot=fig_guich_beh, width = 22, height = 26, units = "cm", dpi = 1200)
knitr::include_graphics("./output/figures/main/fig_guich_beh.png")
```

#### Do species differ in their antipredatory response and flexibility?

Neither the immediate antipredatory response nor the antipredatory flexibility differed between species for any of the treatments and behavioral responses analyzed (see @table-species-contrasts).

_Table 1. Contrasts between species for the intercepts (Response) and slopes (Flexibility) of all the behavioral responses analyzed. Values represent the median (Contrast) and 95% Highest Posterior Density Intervals (95% HPDI) of the posterior distributions of the contrasts. For all contrasts, we calculated the differences betwee Lampropholis delicata - Lampropholis guichenoti. We did not transform the values back to original units. Significant differences are indicated in bold._
```{r, table-species-contrasts}
#| label: table-species-contrasts
#| tbl-cap: "Contrasts between species for the intercepts (Response) and slopes (Flexibility) of all the behavioral responses analyzed. Values represent the median (Contrast) and 95% Highest Posterior Density Intervals (95% HPDI) of the posterior distributions of the contrasts. For all contrasts, we calculated Lampropholis delicata - Lampropholis guichenoti. We did not transform the values back to original units. Significant differences are indicated in bold."
source(here("R", "func.R"))
#
# Getting the contrasts between species (all contrasts are L. delicata - L. guichenoti)
var <- c("move", "shelter", "emergence")
type <- c("int", "slope")

species_contrasts_df <- data.frame()

for(v in var){
  for(t in type){

    value_c1 <- c(
      get(paste0("deli_", v, "_posteriors"))[[paste0(t, "_Control_Cold")]],
      get(paste0("deli_", v, "_posteriors"))[[paste0(t, "_CORT_Cold")]],
      get(paste0("deli_", v, "_posteriors"))[[paste0(t, "_Control_Hot")]],
      get(paste0("deli_", v, "_posteriors"))[[paste0(t, "_CORT_Hot")]]
    )

    value_c2 <- c(
      get(paste0("guich_", v, "_posteriors"))[[paste0(t, "_Control_Cold")]],
      get(paste0("guich_", v, "_posteriors"))[[paste0(t, "_CORT_Cold")]],
      get(paste0("guich_", v, "_posteriors"))[[paste0(t, "_Control_Hot")]],
      get(paste0("guich_", v, "_posteriors"))[[paste0(t, "_CORT_Hot")]]
    )
    
    contrast_values <- value_c1 - value_c2
    median_contrast <- format_dec(median(contrast_values), 3)
    hdi_low <- format_dec(hdi(contrast_values, credMass = 0.95)[1], 3)
    hdi_high <- format_dec(hdi(contrast_values, credMass = 0.95)[2], 3)
    
    temp_df <- data.frame(
      Behavior = v,
      Type = t,
      Median = median_contrast,
      HPDI_Lower = hdi_low,
      HPDI_Upper = hdi_high
    )

    species_contrasts_df <- rbind(species_contrasts_df, temp_df)
  }
} 
#
# Improving database
species_contrasts_clean <- species_contrasts_df %>%
  mutate(
    Behavior = case_when(
      Behavior == "move" ~ "Latency to move",
      Behavior == "shelter" ~ "Latency to shelter",
      Behavior == "emergence" ~ "Probability to emerge"),
    Type = case_when(
      Type == "int" ~ "Response",
      Type == "slope" ~ "Flexibility"),
    `95% HPDI` = paste0(" [", HPDI_Lower, ", ", HPDI_Upper, "]")) %>%
  dplyr::select(Type, Behavior, Median, `95% HPDI`) %>%
  arrange(factor(Type, levels = c("Response", "Flexibility")),
          factor(Behavior, levels = c("Latency to move", "Latency to shelter", "Probability to emerge"))) %>%
data.frame()
# # Set defaults for the table
set_flextable_defaults(
  font.family = "Times New Roman",
  font.size = 10)
#
# Make Table
sp_contrasts_table <-  flextable(species_contrasts_clean) %>%
  flextable::compose(i = 1, j = 3, value = as_paragraph("Contrast"), part = "header") %>% # Change the first column header
  flextable::compose(i = 1, j = 4, value = as_paragraph("95% HPDI"), part = "header") %>% # Change the second column header
  flextable::compose(i = c(2,3,5,6), j = 1, value = as_paragraph(""), part = "body") %>% # Make some blanks
  flextable::hline(i = 3, part = "body") %>% # Add horizontal line
  align(align = "center", j = c(3,4), part = "body") %>%
  align(align = "center", part = "header") %>%
autofit()
#
sp_contrasts_table
```

## Discussion    
We predicted that elevating CORT levels in eggs or incubating them at colder temperatures would increase lizards antipredatory response and decrease antipredatory flexibility. Higher antipredatory response would imply larger latencies to move after the simulated attack, lower times until sheltering, and lower probabilities of emerging from the shelter. And lower antipredatory flexibility would be reflected in a lack of changes in these behaviors over repeated exposures to the simulated attack. Additionally, we predicted between species differences in both the the antipredatory behavior and flexibility, and how early conditions would impact their behavior. However, our results did not support our predictions. Neither prenatal CORT exposure nor incubation temperature influenced the antipredatory response or flexibility in either species. Moreover, we did not find significant differences between species in any of the behavioral responses analyzed.    

#### Antipredatory response is robust to prenatal conditions      
We hypothesized that elevated prenatal CORT and cold incubation temperatures would increase latency to move while decreasing the latency to shelter and the probabilities of emerging from the shelter after a simulated attack. However, neither prenatal CORT exposure or incubation temperature influenced the antipredatory response in either species.             

Given the significant effects of prenatal GCs on the development of the HPA/HPI axis reported in other species [@costantini2011meta; @vargas2016early; @jafari2017prenatal; @zito2017early; @crino2024eggs], we predicted prenatal CORT elevations to increase lizards’ reactivity to a predatory attempt. However, we found no effects of prenatal CORT elevations on any of the behaviors analyzed, and these results were consistent across species. These findings suggest that the antipredatory response is robust to CORT elevations in _L. delicata_ and _L. guichenoti_. Alternatively, our CORT manipulation may have failed to elicit significant effects. Glucocorticoids are known to have hormetic effects on different traits [@mcewen_concept_2003]. While our CORT treatment was efficient in elevating yolk CORT concentrations, they did not result in increased baseline CORT in juveniles [@crino2024eggs]. In contrast, doses at lower concentration did [@crino2024eggs]. Previous reports show that enhanced responsiveness to predatory attempts are usually accompanied by higher baseline GC levels [@koolhaas1999coping; @ruys2004behavioral; @thaker2009acute]. Therefore, the absence of CORT effects on the antipredatory response may reflect the lack of endocrine differences between treatment groups in _L. delicata_. However, this mechanism remains speculative for _L. guichenoti_, as comparable endocrine data are currently lacking. Further experiments would benefit from studying how exposing eggs to lower CORT concentrations influence antipredatory behaviors and stress-related physiology in both species.

Incubation temperature impacts antipredatory behavior in other reptiles [@burger_antipredator_1998; @iglesias2024maternal]. For example, pine snakes (_Pituophis melanoleucus_) incubated at low temperatures were less responsive to a predator - less hissing or striking - than hot incubated ones [@burger_antipredator_1998]. In contrast, we did not see any effects of the prenatal thermal environment on the antipredatory response in either _L. delicata_ or _L. guichenoti_. Similarly, incubation temperature alone did not affect antipredatory behavior in _L. delicata_ or _L. guichenoti_ in previous studies [@iglesias2024maternal]. However, when cold incubation temperature was combined with low maternal investment - simulated by extracting 12.5% of the egg yolk - lizards showed increased antipredatory responses [@iglesias2024maternal]. These results suggest that incubation temperature alone may not be sufficient to alter antipredatory behavior in these species, but it could interact with other early-life conditions to shape antipredatory strategies. Future research should explore how incubation temperature interacts with other prenatal factors to influence antipredatory behavior in these skinks.     

#### Antipredatory flexibility is robust to prenatal conditions
We did not find significant effects of prenatal CORT exposure or incubation temperature on antipredatory flexibility. Either in _L. delicata_, where there was some evidence of flexibility, or in _L. guichenoti_, where no flexibility was observed, prenatal conditions had no significant effects on how lizards modified their antipredatory behavior over repeated exposures to the simulated attack.    

Both prenatal CORT exposure and cold incubation temperatures have been shown to impair cognitive abilities in other species [@lemaire_prenatal_2000; @zhu_prenatal_2004; @amiel_hotter_2012; @costantini2011meta]. Given that complex cognitive processes like behavioral flexibility can be involved in adjusting antipredatory behavior to changing risk levels [@amo2005flexibility], we expected our prenatal conditions to influence antipredatory flexibility. Instead, our study aligns with previous research showing that reversal learning - a standardized proxy of behavioral flexibility - was also unaffected by prenatal CORT and incubation temperature in both species [@recio2025early]. Our findings suggest that some cognitive process may be robust to prenatal CORT exposure and incubation temperature in these species. However, the effects of prenatal GCs and thermal environment on brain development are region-dependent, with some brain nuclei being more impacted than others [@coomber_independent_1997; @lemaire_prenatal_2000]. Hence, different cognitive processes, encoded in different brain regions, may be more sensitive to the effects of early conditions. Future research should explore the combined effects of prenatal CORT and temperature on brain function and other cognitive domains.      

#### Antipredatory response and flexibility do not differ between species
Both _L. delicata_ and _L. guichenoti_ have similar life-histories and ecological niches [@chapple_know_2011; @chapple_biology_2014]. However, while _L. delicata_ is a successful invader in several parts of the world, _L. guichenoti_ has not established populations outside its native range [@chapple2015deliinvLHI]. These differences in invasion success are likely related to differences in behavioral traits, with _L. delicata_ being more exploratory than _L. guichenoti_ [@chapple_know_2011]. Given these differences, we expected _L. delicata_ to show lower antipredatory responses and higher antipredatory flexibility than _L. guichenoti_. However, we did not find any indication of species differences in their antipredatory strategies. Although _L. delicata_ showed some degree of antipredatory flexibility - reflected by a positive slope in the probability of emerging from shelter - the between-species differences were not significant. Our findings suggest that antipredatory strategies do not seem to be a good predictor of the differences in invasion success between these species.            

In addition, both species responded similarly to early-life conditions, with neither prenatal CORT or incubation temperature affecting their antipredatory response or flexibility. Some studies show that invasive species are more plastic and responsive to environmental conditions than non-invasive species [@cordeschi2022plastic; @iglesias2024maternal]. However, we did not find any differences in plasticity between _L. delicata_ and _L. guichenoti_, at least on their antipredatory strategies [see also @recio2025cognitive; @recio2025early]. Future research should explore other behavioral traits that could explain the differences in invasion success between these species and how this traits can be shaped by developmental conditions.    

#### Conclusion
Our study shows that early-life conditions did not influence how skinks respond to a simulated attack. The antipredatory behavior and antipredatory flexibility in both _Lampropholis delicata_ and _L. guichenoti_ were not affected by prenatal CORT and incubation temperature. We also found that only _Lampropholis delicata_ showed some flexibility in their antipredatory strategies, reflected by the increased the probability of emerging from the shelter over time. However, when both species were compared, the differences were not significant. Together, these findings suggest that antipredatory response and antipredatory flexibility in both species are robust to incubation temperature and prenatal GC exposure, and that both species follow similar antipredatory strategies. Future studies should evaluate whether more complex developmental environments can shape antipredatory phenotypes. Besides, it is fundamental to integrate behavioral assays with neurological measures to understand the mechanisms underlying antipredatory response and flexibility. Finally, including other reptile species in this type of studies will help determine whether the robustness of antipredatory behavior to prenatal conditions is unique to _Lampropholis_ or represents a broader pattern.         

## References
<div id="refs"></div>

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

## Supplementary material

_Table S1. Contrasts of the posterior distributions of the predictors for each behavioral variable modelled for L. delicata. The contrasts are between the intercepts (Response) and slopes (Flexibility) of the different treatments. 95% Highest Posterior Density Intervals (95% HPDI) test the hypothesis that the contrasts are different from zero._     

```{r, table_contrasts_deli}
#| label: table_contrasts_deli
#
source(here("R", "func.R"))
# 
# Get the posterior contrasts for L. delicata and merge them into a single df
contrast_deli_beh <- bind_rows(move = deli_move_contrasts,
                              shelter = deli_shelter_contrasts,
                              emergence = deli_emergence_contrasts,
                              .id = "variable") %>%
                    mutate(across(everything(), as.character)) %>%
                    
                    rename_with(~ str_replace_all(., "X2\\.5\\.HDI_", "low_lim_")) %>%
                    rename_with(~ str_replace_all(., "X97\\.5\\.HDI_", "up_lim_")) %>%
 
                    pivot_longer(cols = -variable,
                                names_to = c("type", "factor", "stat"),
                                names_pattern = "(median|low_lim|up_lim)_(.*)_(int|slope)") %>%
 
                    pivot_wider(names_from = c(type, stat),
                                values_from = value) %>%
                    
                    mutate(CI_int = paste0("[", low_lim_int, ", ", up_lim_int, "]"),
                          CI_slope = paste0("[", low_lim_slope, ", ", up_lim_slope, "]")) %>%
                    
                    dplyr::select(variable, factor, median_int, CI_int,
                                  median_slope, CI_slope) %>%
data.frame()
write.csv(contrast_deli_beh, here("./output/checking/contrasts_deli_beh.csv"))
#
#
# Set defaults for the table
set_flextable_defaults(
  font.family = "Times New Roman",
  font.size = 10)
#
# Make Table
table_deli_behavior <- flextable(contrast_deli_beh) %>%
  flextable::compose(i = 1, j = 1, value = as_paragraph("Variable"), part = "header") %>% # Change the first column header
  flextable::compose(i = 1, j = 2, value = as_paragraph("Predictor"), part = "header") %>% # Change the second column header
  flextable::compose(i = 1, j = c(3,5), value = as_paragraph("Contrast"), part = "header") %>% # Change the third column header
  flextable::compose(i = 1, j = c(4,6), value = as_paragraph("95% HPDI"), part = "header") %>% # Change the fourth column header
  flextable::add_header_row(values = c("", "Response", "Flexibility"), colwidths = c(2, 2, 2)) %>% # Add a header row
  flextable::compose(i = c(2,3,5,6,8,9), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
  flextable::compose(i = 1, j = 1, value = as_paragraph("Latency to move"), part = "body") %>% # Change the first row of the first column
  flextable::compose(i = 4, j = 1, value = as_paragraph("Latency to shelter"), part = "body") %>% # Change the fourth row of the first column
  flextable::compose(i = 7, j = 1, value = as_paragraph("Emergence"), part = "body") %>% # Change the seventh row of the first column
  flextable::hline(i = c(3,6), part = "body") %>% # Add horizontal lines
  flextable::vline(j = c(2,4), part = "all") %>% # Add vertical lines
  align(align = "center", j = c(3:6), part = "body") %>%
  align(align = "center", i = c(1,2), j = c(1:6), part = "header") %>%
  flextable::bold(i = 1, j = c(3,4), bold = TRUE, part = "body") %>% 
autofit()
#
table_deli_behavior
```

Contrasts were done by:  
    - _Temperature_: β~Hot~ - β~Cold~  
    - _CORT_: β~CORT~ - β~Control~  
    - _Interaction_: (β~Control-Hot~ - β~CORT-Hot~) - (β~Control-Cold~ - β~CORT-Cold~)  


```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

_Table S2. Contrasts of the posterior distributions of the predictors for each behavioral variable modelled for L. guichenoti. The contrasts are between the intercepts (Response) and slopes (Flexibility) of the different treatments. 95% Highest Posterior Density Intervals (95% HPDI) test the hypothesis that the contrasts are different from zero._    

```{r, table_contrasts_guich}
#| label: table_contrasts_guich
#
source(here("R", "func.R"))
# 
# Get the posterior contrasts for L. guichenoti and merge them into a single df
contrast_guich_beh <- bind_rows(move = guich_move_contrasts,
                              shelter = guich_shelter_contrasts,
                              emergence = guich_emergence_contrasts,
                              .id = "variable") %>%
                    mutate(across(everything(), as.character)) %>%
                    
                    rename_with(~ str_replace_all(., "X2\\.5\\.HDI_", "low_lim_")) %>%
                    rename_with(~ str_replace_all(., "X97\\.5\\.HDI_", "up_lim_")) %>%
 
                    pivot_longer(cols = -variable,
                                names_to = c("type", "factor", "stat"),
                                names_pattern = "(median|low_lim|up_lim)_(.*)_(int|slope)") %>%
 
                    pivot_wider(names_from = c(type, stat),
                                values_from = value) %>%
                    
                    mutate(CI_int = paste0("[", low_lim_int, ", ", up_lim_int, "]"),
                          CI_slope = paste0("[", low_lim_slope, ", ", up_lim_slope, "]")) %>%
                    
                    dplyr::select(variable, factor, median_int, CI_int,
                                  median_slope, CI_slope) %>%
data.frame()
write.csv(contrast_guich_beh, here("./output/checking/contrasts_guich_beh.csv"))
#
#
# Set defaults for the table
set_flextable_defaults(
  font.family = "Times New Roman",
  font.size = 10)
#
# Make Table
table_guich_behavior <- flextable(contrast_guich_beh) %>%
  flextable::compose(i = 1, j = 1, value = as_paragraph("Variable"), part = "header") %>% # Change the first column header
  flextable::compose(i = 1, j = 2, value = as_paragraph("Predictor"), part = "header") %>% # Change the second column header
  flextable::compose(i = 1, j = c(3,5), value = as_paragraph("Contrast"), part = "header") %>% # Change the third column header
  flextable::compose(i = 1, j = c(4,6), value = as_paragraph("95% HPDI"), part = "header") %>% # Change the fourth column header
  flextable::add_header_row(values = c("", "Response", "Flexibility"), colwidths = c(2, 2, 2)) %>% # Add a header row
  flextable::compose(i = c(2,3,5,6,8,9), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
  flextable::compose(i = 1, j = 1, value = as_paragraph("Latency to move"), part = "body") %>% # Change the first row of the first column
  flextable::compose(i = 4, j = 1, value = as_paragraph("Latency to shelter"), part = "body") %>% # Change the fourth row of the first column
  flextable::compose(i = 7, j = 1, value = as_paragraph("Emergence"), part = "body") %>% # Change the seventh row of the first column
  flextable::hline(i = c(3,6), part = "body") %>% # Add horizontal lines
  flextable::vline(j = c(2,4), part = "all") %>% # Add vertical lines
  align(align = "center", j = c(3:6), part = "body") %>%
  align(align = "center", i = c(1,2), j = c(1:6), part = "header") %>% 
autofit()
#
table_guich_behavior
```

Contrasts were done by:  
    - _Temperature_: β~Hot~ - β~Cold~  
    - _CORT_: β~CORT~ - β~Control~  
    - _Interaction_: (β~Control-Hot~ - β~CORT-Hot~) - (β~Control-Cold~ - β~CORT-Cold~)  



```{r, results='asis', echo=FALSE}
cat("\\newpage") 
```

_Table S3. Values of the slopes (indicator of Flexibility) for the different treatments for each behavioral variable modelled for both species. Median shows the median values of the posterior distribution. 95% Highest Density Intervals (95% HPDI) test the hypothesis that the slopes are different from zero._

```{r, table_slopes}
#| label: table_slopes
#
source(here("R", "func.R"))
#
# Get the slopes for both species in a common df
sp <- c("deli", "guich")
var <- c("move", "shelter", "emergence")
#
slopes_table_df <- data.frame()
for(i in sp){
  for(j in var){    
    model_object <- get(paste0(i, "_", j, "_posteriors")) %>%      
      dplyr::select(starts_with("slope_")) %>%
      rename_with(~ str_replace_all(., "slope_", "")) %>%
      pivot_longer(cols = everything(), names_to = "treatment", values_to = "slope") %>%
      group_by(treatment) %>%
      summarize(
        Median = format_dec(median(slope), 3),
        lowlim = format_dec(hdi(slope, credMass = 0.95)[1], 3),
        uplim = format_dec(hdi(slope, credMass = 0.95)[2], 3)) %>%
      mutate(species = i, variable = j)

    slopes_table_df <- rbind(slopes_table_df, model_object)
  }
}
#
table_slopes_df <- slopes_table_df %>%
  mutate(CI = paste0("[", lowlim, ", ", uplim, "]")) %>%
  dplyr::select(species, variable, treatment, Median, CI) %>%
  mutate(treatment = str_replace_all(treatment, "_", "-"),
         treatment = factor(treatment, levels = c("Control-Cold",
                                                  "CORT-Cold",
                                                  "Control-Hot",
                                                  "CORT-Hot")),
        variable = factor(variable, levels = c("move", "shelter", "emergence"))) %>%
  arrange(species, variable, treatment) %>%
data.frame()
write.csv(table_slopes_df, here("./output/checking/table_slopes.csv"))
#
# Set defaults for the table
set_flextable_defaults(
  font.family = "Times New Roman",
  font.size = 10)
#
# Make Table
table_slopes <- flextable(table_slopes_df) %>%
  flextable::compose(i = 1, j = 1, value = as_paragraph("Species"), part = "header") %>% # Change the first column header
  flextable::compose(i = 1, j = 2, value = as_paragraph("Variable"), part = "header") %>% # Change the second column header
  flextable::compose(i = 1, j = 3, value = as_paragraph("Treatment"), part = "header") %>% # Change the third column header
  flextable::compose(i = 1, j = 5, value = as_paragraph("95% HPDI"), part = "header") %>% # Change the fifth column header
  flextable::compose(i = c(2:12,14:24), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
  flextable::compose(i = 1, j = 1, value = as_paragraph(as_i("L. delicata")), part = "body") %>% # Change the first row of the first column
  flextable::compose(i = 13, j = 1, value = as_paragraph(as_i("L. guichenoti")), part = "body") %>% # Change the fourth row of the first column
  flextable::compose(i = c(2:4,6:8,10:12,14:16,18:20,22:24), j = 2, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the second column
  flextable::compose(i = c(1,13), j = 2, value = as_paragraph("Latency to move"), part = "body") %>% # Change the first row of the first column
  flextable::compose(i = c(5,17), j = 2, value = as_paragraph("Latency to shelter"), part = "body") %>% # Change the fourth row of the first column
  flextable::compose(i = c(9,21), j = 2, value = as_paragraph("Emergence"), part = "body") %>% # Change the seventh row of the first column
  flextable::hline(i = c(4,8,16,20), j = c(2:5),part = "body") %>% # Add horizontal lines
  flextable::hline(i = 12, part = "body") %>% # Add horizontal lines
  bold(i = c(2,9,10,11,12), j = c(3:5), bold = TRUE, part = "body") %>% # Bold significant values
  align(align = "center", j = c(4,5), part = "body") %>%
  align(align = "center", j = c(1:5), part = "header") %>% 
autofit()
#
table_slopes
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

```{r, clean_posteriors_tables}
#| label: clean_posteriors_tables
source(here("R", "func.R"))
#
variables <- c("move", "shelter", "emergence")
species <- c("deli", "guich")
# Initialize empty lists
posterior_list <- list(deli = list(), guich = list())
# Loop over species and variables
for(i in species){
  for(j in variables){
    model_object <- get(paste0(i, "_", j))
    result <- tidy_post(df = model_object)
    posterior_list[[i]][[j]] <- result
  }
}
#
deli_post <- dplyr::bind_rows(posterior_list$deli, .id = "variable") %>%
  mutate(CI = paste0("[", low_lim, ", ", up_lim, "]")) %>%                  
  dplyr::select(variable, Predictor, Median, CI) %>%
data.frame()
#
guich_post <- dplyr::bind_rows(posterior_list$guich, .id = "variable") %>%
  mutate(CI = paste0("[", low_lim, ", ", up_lim, "]")) %>%                  
  dplyr::select(variable, Predictor, Median, CI) %>%
data.frame()
```

_Table S4. Estimates of each predictor for each variable modelled for L. delicata. Median indicates the median of the posterior distribution for each estimate. 95% Highest Density Intervals (95% HPDI) test the hypothesis that the estimates are different from zero._     

```{r, tablesummary_deli}
#| label: tablesummary_deli
#
# Table defaults
set_flextable_defaults(
 font.family = "Times New Roman",
 font.size = 10)
# Make Table
table_summ_deli <- flextable(deli_post) %>%
  flextable::compose(i = 1, j = 1, value = as_paragraph("Variable"), part = "header") %>% # Change the first column header
  flextable::compose(i = 1, j = 4, value = as_paragraph("95% HPDI"), part = "header") %>% # Change the last column header
  align(align = "center", j = c(3,4), part = "body") %>%
  align(align = "center", j = c(1:4), part = "header") %>%
  flextable::compose(i = c(2:9,11:18,20:27), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
  flextable::hline(i = c(9,18), part = "body") %>% # Add horizontal lines
  bold(i = c(1,3,8,10,19,20,22), j = c(2:4), bold = TRUE, part = "body") %>% # Bold significant values
  autofit()
#
table_summ_deli
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

_Table S5. Estimates of each predictor for each variable modelled for L. guichenoti. Median indicates the median of the posterior distribution for each estimate. 95% Highest Density Intervals (95% HPDI) test the hypothesis that the estimates are different from zero._

```{r, tablesummary_guich}
#| label: tablesummary_guich
#
# Table defaults
set_flextable_defaults(
 font.family = "Times New Roman",
 font.size = 10)
# Make Table
table_summ_guich <- flextable(guich_post) %>%
  flextable::compose(i = 1, j = 1, value = as_paragraph("Variable"), part = "header") %>% # Change the first column header
  flextable::compose(i = 1, j = 4, value = as_paragraph("95% HPDI"), part = "header") %>% # Change the last column header
  align(align = "center", j = c(3,4), part = "body") %>%
  align(align = "center", j = c(1:4), part = "header") %>% 
  flextable::compose(i = c(2:9,11:18,20:27), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
  flextable::hline(i = c(9,18), part = "body") %>% # Add horizontal lines
  bold(i = c(1,10,26,27), j = c(2:4), bold = TRUE, part = "body") %>% # Bold significant values
  autofit()
#
table_summ_guich
```
